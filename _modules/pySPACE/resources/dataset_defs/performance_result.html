

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pySPACE.resources.dataset_defs.performance_result &mdash; pySPACE 0.5 alpha documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/pySPACE.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.5 alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../../_static/pyspace-logo.ico"/>
    <link rel="top" title="pySPACE 0.5 alpha documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">pySPACE 0.5 alpha documentation</a> &raquo;</li>
          <li><a href="../../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/pyspace-logo_small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pySPACE.resources.dataset_defs.performance_result</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot; Tabular listing data sets, parameters and a huge number of performance metrics</span>

<span class="sd">Store and load the performance results of an operation from a csv file,</span>
<span class="sd">select subsets of this results or for create various kinds of plots</span>

<span class="sd">**Special Static Methods**</span>
<span class="sd">    :merge_performance_results:</span>
<span class="sd">        Merge result*.csv files when classification fails or is aborted.</span>

<span class="sd">    :repair_csv:</span>
<span class="sd">        Wrapper function for whole csv repair process when classification</span>
<span class="sd">        fails or is aborted.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>

<span class="k">try</span><span class="p">:</span> <span class="c"># import packages for plotting</span>
    <span class="kn">import</span> <span class="nn">pylab</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">try</span><span class="p">:</span> <span class="c"># import packages for plotting error bars</span>
    <span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="c"># imports for storing</span>
<span class="kn">import</span> <span class="nn">pwd</span>
<span class="kn">import</span> <span class="nn">yaml</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="c"># csv handling</span>
<span class="kn">import</span> <span class="nn">pySPACE.tools.csv_analysis</span> <span class="kn">as</span> <span class="nn">csv_analysis</span>
<span class="c"># base class</span>
<span class="kn">from</span> <span class="nn">pySPACE.resources.dataset_defs.base</span> <span class="kn">import</span> <span class="n">BaseDataset</span>


<span class="c"># roc imports</span>
<span class="kn">import</span> <span class="nn">cPickle</span> <span class="c"># load roc points</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>

<div class="viewcode-block" id="PerformanceResultSummary"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary">[docs]</a><span class="k">class</span> <span class="nc">PerformanceResultSummary</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Classification performance results summary</span>
<span class="sd">    </span>
<span class="sd">    For the identifiers some syntax rules hold to make some distinction:</span>
<span class="sd">    </span>
<span class="sd">        1.  Parameters/Variables start and end with `__`.</span>
<span class="sd">            These identifiers define the processing differences of the entries.</span>
<span class="sd">            Altogether the corresponding values build a unique key of each row.</span>
<span class="sd">        2.  Normal metrics start with a Big letter and </span>
<span class="sd">            continue normally with small letters except AUC.</span>
<span class="sd">        3.  Meta metrics like training metrics, LOO  metrics or soft metrics</span>
<span class="sd">            start with small letters defining the category followed by a</span>
<span class="sd">            `-` and continue with the detailed metric name.</span>
<span class="sd">        4.  Meta information like chosen optimal parameters can be</span>
<span class="sd">            separated from metrics and variables using `~~`</span>
<span class="sd">            at beginning and end of the information name.</span>
<span class="sd">    </span>
<span class="sd">    This class can load a result tabular (namely the results.csv file) using</span>
<span class="sd">    the factory method :func:`from_csv`.</span>
<span class="sd">    </span>
<span class="sd">    Furthermore, the method :func:`project_onto` allows to select a subset of the</span>
<span class="sd">    result collection where a parameter takes on a certain value.</span>
<span class="sd">    </span>
<span class="sd">    The class contains various methods for plotting the loaded results. </span>
<span class="sd">    These functions are used by the analysis operation and by the interactive</span>
<span class="sd">    analysis GUI.</span>
<span class="sd">    </span>
<span class="sd">    Mainly result collections are loaded for</span>
<span class="sd">    :mod:`~pySPACE.missions.operations.comp_analysis`,</span>
<span class="sd">    :mod:`~pySPACE.missions.operations.analysis` and</span>
<span class="sd">    as best alternative with the :mod:`~pySPACE.run.gui.performance_results_analysis`.</span>
<span class="sd">    </span>
<span class="sd">    They can be build e.g. with the :mod:`~pySPACE.missions.nodes.sink.classification_performance_sink` nodes,</span>
<span class="sd">    with :ref:`MMLF &lt;tutorial_interface_to_mmlf&gt;` or with</span>
<span class="sd">    :class:`~pySPACE.missions.operations.weka_classification.WekaClassificationOperation`.</span>

<span class="sd">    The metrics as result of :mod:`~pySPACE.missions.nodes.sink.classification_performance_sink` nodes</span>
<span class="sd">    are calculated in the :mod:`~pySPACE.resources.dataset_defs.metric` dataset module.</span>

<span class="sd">    .. todo:: Access in result collection via indexing ndarray with one</span>
<span class="sd">              dimension for each parameter.</span>
<span class="sd">              Entries are indexes in list. So the corresponding values</span>
<span class="sd">              can be accessed very fast.</span>

<span class="sd">    .. todo:: Faster, memory efficient loading is needed. Pickling or new data</span>
<span class="sd">              structure?</span>
<span class="sd">    </span>
<span class="sd">    The class constructor expects the following **arguments**:</span>
<span class="sd">    </span>
<span class="sd">      :data:    A dictionary that contains a mapping from an attribute</span>
<span class="sd">                (e.g. accuracy) to a list of values taken by this attribute.</span>
<span class="sd">                An entry is the entirety of all i-th values over all dict-values</span>

<span class="sd">      :tmp_pathlist:</span>
<span class="sd">          List of files to be deleted after successful storing</span>

<span class="sd">          When constructed via `from_multiple_csv` all included csv files</span>
<span class="sd">          can be deleted after the collection is stored.</span>
<span class="sd">          Therefore the parameter `delete` has to be active.</span>
<span class="sd">          </span>
<span class="sd">          (*optional, default:None*)</span>
<span class="sd">    </span>
<span class="sd">      :delete:</span>
<span class="sd">          Switch for deleting files in `tmp_pathlist` after collection is stored.</span>
<span class="sd">          </span>
<span class="sd">          (*optional, default: False*)</span>
<span class="sd">    </span>
<span class="sd">    :Author: Mario M. Krell (mario.krell@dfki.de)</span>
<span class="sd">    &quot;&quot;&quot;</span>
        
<div class="viewcode-block" id="PerformanceResultSummary.__init__"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dataset_md</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">csv_filename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PerformanceResultSummary</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">csv_filename</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dataset_dir</span><span class="p">:</span> <span class="c"># csv_filename is expected to be a path</span>
            <span class="n">dataset_dir</span><span class="o">=</span><span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmp_pathlist</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="k">if</span> <span class="n">dataset_md</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meta_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dataset_md</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">data</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">dataset_dir</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span> <span class="c"># load data</span>
            <span class="k">if</span> <span class="n">csv_filename</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c"># maybe it&#39;s not results.csv but it&#39;s definitely only one file</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">PerformanceResultSummary</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_dir</span><span class="p">,</span>
                                                                   <span class="n">csv_filename</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_dir</span><span class="p">,</span><span class="s">&quot;results.csv&quot;</span><span class="p">)):</span>
                <span class="c"># delegate to from_csv_method</span>
                <span class="n">csv_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataset_dir</span><span class="p">,</span><span class="s">&quot;results.csv&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">PerformanceResultSummary</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="n">csv_file_path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># multiple csv_files</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp_pathlist</span> <span class="o">=</span> \
                        <span class="n">PerformanceResultSummary</span><span class="o">.</span><span class="n">from_multiple_csv</span><span class="p">(</span><span class="n">dataset_dir</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">delete</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="c"># update meta data </span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">splits</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;__Key_Fold__&quot;</span><span class="p">]))</span>
                    <span class="n">runs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;__Key_Run__&quot;</span><span class="p">]))</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Splits and runs not available!&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">meta_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&quot;splits&quot;</span><span class="p">:</span> <span class="n">splits</span><span class="p">,</span> <span class="s">&quot;runs&quot;</span><span class="p">:</span> <span class="n">runs</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span> <span class="c"># we have a problem</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s">&quot;Result tabular could not be created - data is missing!&quot;</span><span class="p">,</span>
                      <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Result tabular could not be created - data is missing!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># modifier for getting general box plots in Gui</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;None&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;None&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;All&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="c"># indexed version of the data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
        </div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PerformanceResultSummary.from_csv"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.from_csv">[docs]</a>    <span class="k">def</span> <span class="nf">from_csv</span><span class="p">(</span><span class="n">csv_file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Loading data from the csv file located under *csv_file_path* &quot;&quot;&quot;</span>
<span class="c">#        # pickle loading</span>
<span class="c">#        try:</span>
<span class="c">#            if csv_file_path.endswith(&quot;pickle&quot;):</span>
<span class="c">#                f = open(csv_file_path, &quot;rb&quot;)</span>
<span class="c">#            elif csv_file_path.endswith(&quot;csv&quot;):</span>
<span class="c">#                f = open(csv_file_path[:-3] + &quot;pickle&quot;, &#39;rb&#39;)</span>
<span class="c">#            res=cPickle.load(f)</span>
<span class="c">#            f.close()</span>
<span class="c">#            return res</span>
<span class="c">#        except IOError:</span>
<span class="c">#            pass</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">csv_analysis</span><span class="o">.</span><span class="n">csv2dict</span><span class="p">(</span><span class="n">csv_file_path</span><span class="p">)</span>
        <span class="n">PerformanceResultSummary</span><span class="o">.</span><span class="n">translate_weka_key_schemes</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<span class="c">#        # save better csv version</span>
<span class="c">#        f = open(csv_file_path[:-3] + &quot;pickle&quot;, &quot;wb&quot;)</span>
<span class="c">#        f.write(cPickle.dumps(res, protocol=2))</span>
<span class="c">#        f.close()</span>
        <span class="k">return</span> <span class="n">data_dict</span>
    </div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PerformanceResultSummary.from_multiple_csv"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.from_multiple_csv">[docs]</a>    <span class="k">def</span> <span class="nf">from_multiple_csv</span><span class="p">(</span><span class="n">input_dir</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; All csv files in the only function parameter &#39;input_dir&#39; are </span>
<span class="sd">        combined to just one result collection </span>
<span class="sd">        </span>
<span class="sd">        Deleting of files will be done in the store method, *after*</span>
<span class="sd">        the result is stored successfully.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># A list of all result files (one per classification process)</span>
        <span class="n">pathlist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span>
                                          <span class="s">&quot;results_*&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pathlist</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;No files in the format &quot;results_*&quot; found for merging results!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">result_dict</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># For all result files of the WEKA processes</span>
        <span class="k">for</span> <span class="n">input_file_name</span> <span class="ow">in</span> <span class="n">pathlist</span><span class="p">:</span>
            <span class="c"># first occurrence</span>
            <span class="k">if</span> <span class="n">result_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">result_dict</span> <span class="o">=</span> <span class="n">csv_analysis</span><span class="o">.</span><span class="n">csv2dict</span><span class="p">(</span><span class="n">input_file_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">csv_analysis</span><span class="o">.</span><span class="n">csv2dict</span><span class="p">(</span><span class="n">input_file_name</span><span class="p">)</span>
                <span class="n">csv_analysis</span><span class="o">.</span><span class="n">extend_dict</span><span class="p">(</span><span class="n">result_dict</span><span class="p">,</span><span class="n">result</span><span class="p">)</span>
        
        <span class="n">PerformanceResultSummary</span><span class="o">.</span><span class="n">translate_weka_key_schemes</span><span class="p">(</span><span class="n">result_dict</span><span class="p">)</span>
        <span class="n">PerformanceResultSummary</span><span class="o">.</span><span class="n">tranfer_Key_Dataset_to_parameters</span><span class="p">(</span><span class="n">result_dict</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">result_dict</span><span class="p">,</span> <span class="n">pathlist</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.transform"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Fix format problems like floats in metric columns and tuples instead of column lists &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metrics</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="nb">float</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Metric </span><span class="si">%s</span><span class="s"> has entry </span><span class="si">%s</span><span class="s"> not of type float.&quot;</span><span class="o">%</span><span class="p">(</span>
                    <span class="n">key</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">==</span><span class="nb">tuple</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    </div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PerformanceResultSummary.merge_traces"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.merge_traces">[docs]</a>    <span class="k">def</span> <span class="nf">merge_traces</span><span class="p">(</span><span class="n">input_dir</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Traverse directory tree, merge the classification trace files and store them</span>
<span class="sd">        </span>
<span class="sd">        The collected results are stored in a common file in the input *input_dir*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">cPickle</span>
        <span class="n">traces</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">long_traces</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">save_long_traces</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">sorted_keys</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># save merged files to delete them later</span>
        <span class="n">merged_files</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">dir_path</span><span class="p">,</span><span class="n">dir_names</span><span class="p">,</span><span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">input_dir</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;trace_sp&quot;</span><span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">main_directory</span> <span class="o">=</span> <span class="n">dir_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
                <span class="c"># needed in tranfer_Key_Dataset_to_parameters</span>
                <span class="n">temp_key_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
                <span class="c"># add a temporal Key_Dataset, deleted in next step </span>
                <span class="n">temp_key_dict</span><span class="p">[</span><span class="s">&quot;Key_Dataset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">main_directory</span><span class="p">]</span>
                <span class="c"># read parameters from key dataset</span>
                <span class="n">PerformanceResultSummary</span><span class="o">.</span><span class="n">tranfer_Key_Dataset_to_parameters</span><span class="p">(</span><span class="n">temp_key_dict</span><span class="p">)</span>
                <span class="n">key_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">temp_key_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
                <span class="c"># add run/split identifiers</span>
                <span class="n">split_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filename</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">7</span><span class="p">])</span> <span class="c"># from trace_spX.pickle</span>
                <span class="n">key_dict</span><span class="p">[</span><span class="s">&quot;__Key_Fold__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_number</span>
                <span class="n">run_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dir_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">15</span><span class="p">:])</span> <span class="c"># from persistency_runX</span>
                <span class="n">key_dict</span><span class="p">[</span><span class="s">&quot;__Key_Run__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_number</span>
                <span class="c"># transfer keys to hashable tuple of values</span>
                <span class="c"># the keys should always be the same</span>
                <span class="k">if</span> <span class="n">sorted_keys</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">key_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="n">traces</span><span class="p">[</span><span class="s">&quot;parameter_keys&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">sorted_keys</span>
                    <span class="n">long_traces</span><span class="p">[</span><span class="s">&quot;parameter_keys&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">sorted_keys</span>
                <span class="n">identifier</span><span class="o">=</span><span class="p">[]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">:</span>
                    <span class="n">identifier</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="c"># load the actual classification trace</span>
                <span class="n">trace</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">dir_path</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">))</span>
                <span class="n">traces</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">identifier</span><span class="p">)]</span> <span class="o">=</span> <span class="n">trace</span>
                <span class="n">merged_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir_path</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">save_long_traces</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">trace</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">dir_path</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span><span class="s">&quot;long_&quot;</span><span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">))</span>
                        <span class="n">long_traces</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">identifier</span><span class="p">)]</span> <span class="o">=</span> <span class="n">trace</span>
                        <span class="n">merged_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir_path</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span><span class="s">&quot;long_&quot;</span><span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                        <span class="n">save_long_traces</span> <span class="o">=</span> <span class="bp">False</span>
                
        <span class="c"># clean up</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sorted_keys</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;traces.pickle&#39;</span>
            <span class="n">result_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span>
            <span class="n">result_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cPickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">traces</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">result_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">save_long_traces</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;long_traces.pickle&#39;</span>
                <span class="n">result_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="s">&quot;wb&quot;</span><span class="p">)</span>
                <span class="n">result_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cPickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">long_traces</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">result_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">temp_file</span> <span class="ow">in</span> <span class="n">merged_files</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temp_file</span><span class="p">)</span>
    </div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PerformanceResultSummary.translate_weka_key_schemes"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.translate_weka_key_schemes">[docs]</a>    <span class="k">def</span> <span class="nf">translate_weka_key_schemes</span><span class="p">(</span><span class="n">data_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Data dict is initialized as &#39;defaultdict(list)&#39; and</span>
<span class="sd">        so the append function will work on non existing keys.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&quot;Key_Scheme&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;Key_scheme&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iter</span><span class="p">():</span>
                <span class="c"># Some special cases</span>
                <span class="c"># For these cases we rewrite the value to be meaningful</span>
                <span class="c"># Important parts of &quot;Key_Scheme_Options&quot; will be added to &quot;Key_Scheme&quot;</span>
                <span class="c"># Furthermore we introduce numerous new variables to benchmark</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s">&quot;SMO&quot;</span><span class="p">:</span>
                    <span class="n">options</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;Key_Scheme_options&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Classifier_Type__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                        <span class="c"># Search kernel type</span>
                        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;supportVector&quot;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;Kernel_Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">)</span>
                            <span class="k">break</span>
                        <span class="c"># Search complexity</span>
                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-C&quot;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">complexity</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Complexity__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complexity</span><span class="p">)</span>
                            <span class="c"># Add to value the complexity</span>
                            <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; C=</span><span class="si">%s</span><span class="s">&quot;</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">kernel_type</span> <span class="o">==</span> <span class="s">&#39;PolyKernel&#39;</span><span class="p">:</span>
                        <span class="c"># Search exponent in options of PolyKernel</span>
                        <span class="n">exponent</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">options</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;-E&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span> <span class="ow">in</span> <span class="n">exponent</span><span class="p">:</span>
                            <span class="n">exponent</span> <span class="o">=</span> <span class="n">exponent</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="c">#Add Kernel Type and Exponent to value</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Exponent__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exponent</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">exponent</span> <span class="o">==</span> <span class="s">&quot;0&quot;</span><span class="p">:</span>
                            <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s"> Exp=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; linear&quot;</span>
                        <span class="c"># unimportant parameter</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Gamma__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">kernel_type</span> <span class="o">==</span> <span class="s">&#39;RBFKernel&#39;</span><span class="p">:</span>
                        <span class="c"># Search gamma in options of RBFKernel</span>
                        <span class="n">gamma</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">options</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;-G&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span> <span class="ow">in</span> <span class="n">gamma</span><span class="p">:</span>
                            <span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Gamma__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
                        <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s"> G=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
                        <span class="c"># unimportant parameter</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Exponent__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c">#TODO: Warning: unknown kernel</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Exponent__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Gamma__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="c"># parameters used additionally in libsvm</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Offset__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Weight__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                
                <span class="c"># LibSVM works the same way as SMO and comes with WEKA.</span>
                <span class="c"># For NodeChainOperations a better version is integrated in C++</span>
                <span class="c"># It has more options, especially to weight the classes, to make oversampling unnecessary</span>
                <span class="c"># When using nonlinear kernels,</span>
                <span class="c"># one should consider the influence of the offset and for polynomial k. the scaling factor gamma.</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s">&quot;LibSVM&quot;</span><span class="p">:</span>
                    <span class="n">options</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;Key_Scheme_options&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;-W&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-S&quot;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="c"># 0 -- C-SVC</span>
                            <span class="c"># 1 -- nu-SVC</span>
                            <span class="c"># 2 -- one-class SVM</span>
                            <span class="c"># 3 -- epsilon-SVR</span>
                            <span class="c"># 4 -- nu-SVR</span>
                            <span class="n">classifier</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">classifier</span> <span class="o">==</span> <span class="s">&quot;0&quot;</span><span class="p">:</span>
                                <span class="n">classifier</span> <span class="o">=</span><span class="s">&quot;C_CVC&quot;</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Classifier_Type__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>
                            <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">classifier</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-K&quot;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="c"># 0 -- linear: u&#39;*v</span>
                            <span class="c"># 1 -- polynomial: (gamma*u&#39;*v + coef0)^degree</span>
                            <span class="c"># 2 -- radial basis function: exp(-gamma*|u-v|^2)</span>
                            <span class="c"># 3 -- sigmoid: tanh(gamma*u&#39;*v + coef0)</span>
                            <span class="n">kernel</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">kernel</span>  <span class="o">==</span> <span class="s">&quot;0&quot;</span><span class="p">:</span>
                                <span class="n">kernel</span> <span class="o">=</span> <span class="s">&quot;linear&quot;</span>
                            <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s">&quot;1&quot;</span><span class="p">:</span>
                                <span class="n">kernel</span> <span class="o">=</span> <span class="s">&quot;polynomial&quot;</span>
                            <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s">&quot;2&quot;</span><span class="p">:</span>
                                <span class="n">kernel</span> <span class="o">=</span> <span class="s">&quot;RBF&quot;</span>
                            <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s">&quot;3&quot;</span><span class="p">:</span>
                                <span class="n">kernel</span> <span class="o">=</span> <span class="s">&quot;sigmoid&quot;</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Type__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
                            <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-C&quot;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">complexity</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Complexity__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complexity</span><span class="p">)</span>
                            <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; C=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">complexity</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-D&quot;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">degree</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Exponent__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">degree</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">degree</span> <span class="o">==</span> <span class="s">&quot;0&quot;</span><span class="p">:</span>
                                <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; Exp=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">degree</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-G&quot;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">gamma</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Gamma__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">gamma</span> <span class="o">==</span> <span class="s">&quot;0.0&quot;</span><span class="p">:</span>
                                <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; G=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-R&quot;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">coef0</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Offset__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coef0</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">coef0</span> <span class="o">==</span> <span class="s">&quot;0.0&quot;</span><span class="p">:</span>
                                <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; c0=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coef0</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;W&quot;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">&quot;</span> <span class="ow">in</span> <span class="n">weight</span><span class="p">:</span>
                                <span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\\&quot;</span><span class="s">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Weight__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">weight</span> <span class="o">==</span> <span class="s">&quot;1.0 1.0&quot;</span><span class="p">:</span>
                                <span class="n">value</span> <span class="o">+=</span> <span class="s">&quot; W=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">weight</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c"># TODO: Warning: unknown classifier</span>
                    <span class="c"># All parameters of the two integrated classifier to make analysis operation compatible with other classifiers</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Type__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Complexity__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Exponent__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Gamma__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Offset__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;__Kernel_Weight__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;Key_Scheme&quot;</span><span class="p">]</span>
        <span class="c">## Done</span>
    </div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PerformanceResultSummary.merge_performance_results"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.merge_performance_results">[docs]</a>    <span class="k">def</span> <span class="nf">merge_performance_results</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">delete_files</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Merge result*.csv files when classification fails or is aborted.</span>
<span class="sd">        </span>
<span class="sd">        Use function with the pathname where the csv-files are stored.</span>
<span class="sd">        E.g., merge_performance_results(&#39;/Users/seeland/collections/20100812_11_18_58&#39;)</span>
<span class="sd">        </span>
<span class="sd">        **Parameters**</span>
<span class="sd">        </span>
<span class="sd">            :input_dir:</span>
<span class="sd">                Contains a string with the path where csv files are stored.</span>

<span class="sd">            :delete_files:</span>
<span class="sd">                controls if the csv-files will be removed after merging has finished</span>
<span class="sd">                </span>
<span class="sd">                (optional, default: False)</span>
<span class="sd">        </span>
<span class="sd">        :Author: Mario Krell</span>
<span class="sd">        :Created: 2011/09/21</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">PerformanceResultSummary</span><span class="p">(</span><span class="n">dataset_dir</span><span class="o">=</span><span class="n">input_dir</span><span class="p">)</span>
        <span class="n">collection</span><span class="o">.</span><span class="n">delete</span> <span class="o">=</span> <span class="n">delete_files</span>
        <span class="n">collection</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">input_dir</span><span class="p">)</span>
    </div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PerformanceResultSummary.repair_csv"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.repair_csv">[docs]</a>    <span class="k">def</span> <span class="nf">repair_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">num_splits</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">default_dict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">delete_files</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper function for whole csv repair process when classification fails</span>
<span class="sd">           or is aborted.</span>
<span class="sd">        </span>
<span class="sd">        This function performs merge_performance_results, reporting and reconstruction of missing</span>
<span class="sd">        conditions, and a final merge. As a result two files are written:</span>
<span class="sd">        results.csv and repaired_results.csv to the path specified.</span>
<span class="sd">        </span>
<span class="sd">        **Parameters**</span>
<span class="sd">            :path:</span>
<span class="sd">                String containing the path where the classification results are</span>
<span class="sd">                stored. This path is also used for storing the resulting csv files.</span>

<span class="sd">            :num_splits:</span>
<span class="sd">                Number of splits used for classification. If not specified</span>
<span class="sd">                this information is read out from the csv file of the merge_performance_results</span>
<span class="sd">                procedure.</span>

<span class="sd">                (optional, default: None)</span>

<span class="sd">            :default_dict:</span>
<span class="sd">                A dictionary specifying default values for missing</span>
<span class="sd">                conditions. This dictionary can e.g. be constructed using</span>
<span class="sd">                empty_dict(csv_dict) and subsequent modification, e.g.</span>
<span class="sd">                default_dict[&#39;Metric&#39;].append(0). This parameter is used in</span>
<span class="sd">                reconstruct_failures.</span>
<span class="sd">                </span>
<span class="sd">                (optional, default: None)</span>

<span class="sd">            :delete_files:</span>
<span class="sd">                Controls if unnecessary files are deleted by merge_performance_results and</span>
<span class="sd">                check_op_libSVM.</span>

<span class="sd">                (optional, default: True)</span>
<span class="sd">                </span>
<span class="sd">        :Author: Mario Krell, Sirko Straube</span>
<span class="sd">        :Created: 2010/11/09</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">PerformanceResultSummary</span><span class="o">.</span><span class="n">merge_performance_results</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">delete_files</span><span class="o">=</span><span class="n">delete_files</span><span class="p">)</span>
        <span class="n">filename</span><span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s">&#39;/results.csv&#39;</span>

        <span class="n">csv_dict</span> <span class="o">=</span> <span class="n">csv_analysis</span><span class="o">.</span><span class="n">csv2dict</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="ow">not</span> <span class="n">num_splits</span><span class="p">:</span>
            <span class="n">num_splits</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">csv_dict</span><span class="p">[</span><span class="s">&#39;__Key_Fold__&#39;</span><span class="p">]))</span>
        
        <span class="n">oplist</span><span class="o">=</span> <span class="n">csv_analysis</span><span class="o">.</span><span class="n">check_op_libSVM</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">delete_file</span><span class="o">=</span><span class="n">delete_files</span><span class="p">)</span>
            
        <span class="n">failures</span> <span class="o">=</span> <span class="n">csv_analysis</span><span class="o">.</span><span class="n">report_failures</span><span class="p">(</span><span class="n">oplist</span><span class="p">,</span> <span class="n">num_splits</span><span class="p">)</span>
        <span class="n">final_dict</span><span class="o">=</span> <span class="n">csv_analysis</span><span class="o">.</span><span class="n">reconstruct_failures</span><span class="p">(</span><span class="n">csv_dict</span><span class="p">,</span> <span class="n">failures</span><span class="p">,</span>
                                        <span class="n">num_splits</span><span class="p">,</span> <span class="n">default_dict</span><span class="o">=</span><span class="n">default_dict</span><span class="p">)</span>
        <span class="n">csv_analysis</span><span class="o">.</span><span class="n">dict2csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s">&#39;/repaired_results.csv&#39;</span><span class="p">,</span> <span class="n">final_dict</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.store"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.store">[docs]</a>    <span class="k">def</span> <span class="nf">store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result_dir</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;results&quot;</span><span class="p">,</span> <span class="n">s_format</span> <span class="o">=</span> <span class="s">&quot;csv&quot;</span><span class="p">,</span> <span class="n">main_metric</span><span class="o">=</span><span class="s">&quot;Balanced_accuracy&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Stores this collection in the directory *result_dir*.</span>
<span class="sd">        </span>
<span class="sd">        In contrast to *dump* this method stores the collection</span>
<span class="sd">        not in a single file but as a whole directory structure with meta</span>
<span class="sd">        information etc. </span>
<span class="sd">        </span>
<span class="sd">        **Parameters**</span>
<span class="sd">        </span>
<span class="sd">          :result_dir: The directory in which the collection will be stored</span>
<span class="sd">          :name: The name of the file in which the result file is stored.</span>

<span class="sd">                 (*optional, default: &#39;results&#39;*)</span>

<span class="sd">          :s_format: The format in which the actual data sets should be stored.</span>

<span class="sd">                     (*optional, default: &#39;csv&#39;*)</span>

<span class="sd">          :main_metric: Name of the metric used for the shortened stored file.</span>
<span class="sd">                        If no metric is given, no shortened version is stored.</span>

<span class="sd">                        (*optional, default: &#39;Balanced_accuracy&#39;*)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">author</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">.</span><span class="n">getpwuid</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getuid</span><span class="p">())[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">author</span> <span class="o">=</span> <span class="s">&quot;unknown&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s">&quot;Author could not be resolved.&quot;</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
        <span class="c"># Update the meta data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_meta_data</span><span class="p">({</span><span class="s">&quot;type&quot;</span> <span class="p">:</span> <span class="s">&quot;result&quot;</span><span class="p">,</span>
                               <span class="s">&quot;storage_format&quot;</span><span class="p">:</span> <span class="n">s_format</span><span class="p">,</span>
                               <span class="s">&quot;author&quot;</span> <span class="p">:</span> <span class="n">author</span><span class="p">})</span>
        
        <span class="c"># file name in which the operation&#39;s results will be stored</span>
        <span class="n">output_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result_dir</span><span class="p">,</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="n">s_format</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Writing results to </span><span class="si">%s</span><span class="s"> ...&quot;</span> <span class="o">%</span> <span class="n">output_file_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s_format</span> <span class="o">==</span> <span class="s">&quot;csv&quot;</span><span class="p">:</span>
            <span class="c">#Store meta data</span>
            <span class="n">BaseDataset</span><span class="o">.</span><span class="n">store_meta_data</span><span class="p">(</span><span class="n">result_dir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">meta_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">csv_analysis</span><span class="o">.</span><span class="n">dict2csv</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">main_metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
                <span class="n">reduced_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variables</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">reduced_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">reduced_data</span><span class="p">[</span><span class="n">main_metric</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">main_metric</span><span class="p">]</span>
                <span class="n">metric_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;True_positives&quot;</span><span class="p">,</span><span class="s">&quot;True_negatives&quot;</span><span class="p">,</span><span class="s">&quot;False_negatives&quot;</span><span class="p">,</span><span class="s">&quot;False_positives&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">metric_list</span><span class="p">]:</span>
                    <span class="n">reduced_data</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span>
                <span class="n">output_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result_dir</span><span class="p">,</span><span class="s">&quot;short_&quot;</span><span class="o">+</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="n">s_format</span><span class="p">)</span>
                <span class="n">csv_analysis</span><span class="o">.</span><span class="n">dict2csv</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">,</span> <span class="n">reduced_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s">&quot;The format </span><span class="si">%s</span><span class="s"> is not supported!&quot;</span><span class="o">%</span><span class="n">s_format</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">temp_result_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp_pathlist</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temp_result_file</span><span class="p">)</span>
</div>
    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PerformanceResultSummary.tranfer_Key_Dataset_to_parameters"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.tranfer_Key_Dataset_to_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">tranfer_Key_Dataset_to_parameters</span><span class="p">(</span><span class="n">data_dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&quot;Key_Dataset&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">data_dict</span>
        
        <span class="k">for</span> <span class="n">key_dataset</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;Key_Dataset&quot;</span><span class="p">]:</span>
            <span class="n">components</span> <span class="o">=</span> <span class="p">(</span><span class="n">key_dataset</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;&#39;}{&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;}{&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c"># for compatibility with old data: index 1 might be the</span>
                    <span class="c"># specification file name</span>
                    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="s">&quot;#&quot;</span> <span class="ow">in</span> <span class="n">attribute</span><span class="p">):</span>
                        <span class="n">attribute_key</span> <span class="o">=</span> <span class="s">&quot;__Template__&quot;</span>
                        <span class="n">attribute_value</span> <span class="o">=</span> <span class="n">attribute</span>
                        <span class="k">continue</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">attribute_key</span><span class="p">,</span> <span class="n">attribute_value</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">ValueError when splitting attributes!&quot;</span><span class="p">)</span>
                        <span class="k">print</span> <span class="s">&quot;ValueError in result collection when splitting attributes.&quot;</span>
                        <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">attribute_key</span> <span class="o">=</span> <span class="s">&quot;__Dataset__&quot;</span>
                    <span class="n">attribute_value</span> <span class="o">=</span> <span class="n">attribute</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">attribute_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attribute_value</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">data_dict</span><span class="p">[</span><span class="s">&quot;Key_Dataset&quot;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="PerformanceResultSummary.project_onto"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.project_onto">[docs]</a>    <span class="k">def</span> <span class="nf">project_onto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_parameter</span><span class="p">,</span> <span class="n">proj_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project result collection onto a subset that fulfills all criteria</span>
<span class="sd">        </span>
<span class="sd">        Project the result collection onto the rows where the parameter</span>
<span class="sd">        *proj_parameter* takes on the value *proj_value*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">proj_values</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">proj_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">proj_values</span><span class="p">]</span>
        <span class="n">projected_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">entries_added</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">proj_parameter</span><span class="p">])):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">proj_parameter</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">proj_values</span><span class="p">:</span>
                <span class="n">entries_added</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">for</span> <span class="n">column_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
                    <span class="c"># will leave projection column  in place if there are</span>
                    <span class="c"># still different values for this parameter</span>
                    <span class="k">if</span> <span class="n">column_key</span> <span class="o">==</span> <span class="n">proj_parameter</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">proj_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">continue</span>
                    <span class="n">projected_dict</span><span class="p">[</span><span class="n">column_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">column_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="c"># If the projected_dict is empty we continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entries_added</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="n">PerformanceResultSummary</span><span class="p">(</span><span class="n">projected_dict</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.get_gui_metrics"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_gui_metrics">[docs]</a>    <span class="k">def</span> <span class="nf">get_gui_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the columns in data that correspond to metrics for visualization. </span>
<span class="sd">        </span>
<span class="sd">        This excludes &#39;Key_Dataset&#39; and gui variables of the tabular,</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gui_variables</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;Key_Dataset&#39;</span><span class="p">]):</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="c"># Add variables, that can be interpreted as metrics</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;__Num_Retained_Features__&#39;</span><span class="p">,</span><span class="s">&#39;__Num_Eliminated_Sensors__&#39;</span><span class="p">]</span>\
                <span class="ow">or</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;~&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s">&quot;Pon&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">)</span>\
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])))</span> <span class="o">&gt;</span> <span class="mi">1</span>\
                <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">):</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">metrics</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.get_metrics"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_metrics">[docs]</a>    <span class="k">def</span> <span class="nf">get_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the columns in data that are real metrics &quot;&quot;&quot;</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variables</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;~&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">key</span><span class="o">==</span><span class="s">&quot;None&quot;</span><span class="p">:</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="c"># Add variables, that can be interpreted as metrics</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;__Num_Retained_Features__&#39;</span><span class="p">,</span><span class="s">&#39;__Num_Eliminated_Sensors__&#39;</span><span class="p">]):</span>
                 <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">metrics</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.get_gui_variables"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_gui_variables">[docs]</a>    <span class="k">def</span> <span class="nf">get_gui_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the column headings that correspond to&#39;variables&#39; to be visualized in the Gui &quot;&quot;&quot;</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="o">==</span> <span class="s">&#39;None&#39;</span>  <span class="c">#special key to get box plots without parameter dependencies</span>
                <span class="ow">or</span> <span class="p">((</span><span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;__Dataset__&#39;</span><span class="p">,</span> <span class="s">&#39;Kernel_Weight&#39;</span><span class="p">,</span> <span class="s">&#39;Complexity&#39;</span><span class="p">,</span>
                           <span class="s">&#39;Kernel_Exponent&#39;</span><span class="p">,</span> <span class="s">&#39;Kernel_Gamma&#39;</span><span class="p">,</span> <span class="s">&#39;Kernel_Offset&#39;</span><span class="p">,</span>
                           <span class="s">&#39;Classifier_Type&#39;</span><span class="p">,</span> <span class="s">&#39;Kernel_Type&#39;</span><span class="p">,</span> <span class="s">&#39;Key_Scheme&#39;</span><span class="p">,</span>
                           <span class="s">&#39;Key_Run&#39;</span><span class="p">,</span> <span class="s">&#39;Key_Fold&#39;</span><span class="p">,</span><span class="s">&#39;Run&#39;</span><span class="p">,</span><span class="s">&#39;Split&#39;</span><span class="p">]</span> 
                           <span class="c"># old variable names kept for </span>
                <span class="ow">or</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;__&#39;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;~&#39;</span><span class="p">)</span>
                <span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">key</span><span class="o">==</span><span class="s">&quot;__Solver_Iterations__&quot;</span> <span class="c"># old naming :(</span>
                        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)):</span>
                <span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">variables</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.get_variables"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_variables">[docs]</a>    <span class="k">def</span> <span class="nf">get_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Variables are marked with &#39;__&#39; </span>
<span class="sd">        </span>
<span class="sd">        Everything else are metrics, meta metrics or processing informations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">key</span><span class="o">==</span><span class="s">&quot;__Solver_Iterations__&quot;</span><span class="p">:</span>
                <span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">variables</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.get_parameter_values"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_parameter_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameter_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the values that *parameter* takes on in the data &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">])</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.get_nominal_parameters"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_nominal_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_nominal_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns a generator over the nominal parameters in *parameters*</span>

<span class="sd">        .. note:: Nearly same code as in *get_numeric_parameters*.</span>
<span class="sd">                  Changes in this method should be done also to this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c"># Try to create a float of the first value of the parameter</span>
                <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="c"># No exception and enough entities thus a numeric attribute</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]))</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">parameter</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c"># This is not a numeric parameter, treat it as nominal</span>
                <span class="k">yield</span> <span class="n">parameter</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="c"># This exception should inform the user about wrong parameters</span>
                <span class="c"># in his YAML file.</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;The parameter &quot;&#39;</span> <span class="o">+</span> <span class="n">parameter</span> 
                              <span class="o">+</span> <span class="s">&#39;&quot; is not contained in the PerformanceResultSummary&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="c"># This exception informs the user about wrong parameters in </span>
                <span class="c"># his YAML file.</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;The parameter &quot;&#39;</span> <span class="o">+</span> <span class="n">parameter</span> 
                              <span class="o">+</span> <span class="s">&#39;&quot; has no values.&#39;</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.get_numeric_parameters"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_numeric_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_numeric_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns a generator over the numeric parameters in *parameters*</span>

<span class="sd">        .. note:: Nearly same code as in *get_nominal_parameters*.</span>
<span class="sd">                  Changes in this method should be done also to this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c"># Try to create a float of the first value of the parameter</span>
                <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="c"># No exception and enough entities thus a numeric attribute</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">]))</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">parameter</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c"># This is not a numeric parameter, treat it as nominal</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="c">#&quot;This exception should inform the user about wrong parameters </span>
                <span class="c"># in his YAML file.&quot;</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;The parameter &quot;&#39;</span> <span class="o">+</span> <span class="n">parameter</span> 
                              <span class="o">+</span> <span class="s">&#39;&quot; is not contained in the PerformanceResultSummary&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="c">#This exception informs the user about wrong parameters in</span>
                <span class="c"># his YAML file.</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;The parameter &quot;&#39;</span> <span class="o">+</span> <span class="n">parameter</span> 
                              <span class="o">+</span> <span class="s">&#39;&quot; has no values.&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PerformanceResultSummary.dict2tuple"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.dict2tuple">[docs]</a>    <span class="k">def</span> <span class="nf">dict2tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dictionary</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dictionary values sorted by key names &quot;&quot;&quot;</span>
        <span class="n">keys</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PerformanceResultSummary.get_indexed_data"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_indexed_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_indexed_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Take the variables and create a dictionary with variable entry tuples as keys &quot;&quot;&quot;</span>
        <span class="c"># index keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_variables</span><span class="p">())</span>
        <span class="c"># other keys</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifiers</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">]</span>
        <span class="c"># final dictionary</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]])):</span>
            <span class="n">var_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">perf_dict</span> <span class="o">=</span> <span class="p">{}</span> 
            <span class="c"># read out variable values</span>
            <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">variable</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">var_dict</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>  <span class="o">=</span> <span class="n">value</span>
                <span class="n">perf_dict</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c"># read out the rest</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">perf_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="c"># save it into dictionary by mapping values to tuple as key/index</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dict2tuple</span><span class="p">(</span><span class="n">var_dict</span><span class="p">)]</span> <span class="o">=</span> <span class="n">perf_dict</span>
        <span class="k">return</span> <span class="n">data_dict</span>
</div>
<div class="viewcode-block" id="PerformanceResultSummary.get_performance_entry"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.get_performance_entry">[docs]</a>    <span class="k">def</span> <span class="nf">get_performance_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the line in the data, which corresponds to the `search_dict` &quot;&quot;&quot;</span>
        <span class="n">search_tuple</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict2tuple</span><span class="p">(</span><span class="n">search_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indexed_data</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">search_tuple</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PerformanceResultSummary.plot_numeric"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.plot_numeric">[docs]</a>    <span class="k">def</span> <span class="nf">plot_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">x_key</span><span class="p">,</span> <span class="n">y_key</span><span class="p">,</span> <span class="n">conditions</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; Creates a plot of the y_key for the given numeric parameter x_key.  </span>
<span class="sd">        </span>
<span class="sd">        A function that allows to create a plot that visualizes the effect </span>
<span class="sd">        of differing one variable onto a second one (e.g. the effect of  </span>
<span class="sd">        differing the number of features onto the accuracy). </span>
<span class="sd">        </span>
<span class="sd">        **Expected arguments**</span>
<span class="sd">        </span>
<span class="sd">          :axes: The axes into which the plot is written</span>
<span class="sd">          :x_key: The key of the dictionary whose values should be used as</span>
<span class="sd">                  values for the x-axis (the independent variable)</span>
<span class="sd">          :y_key:   The key of the dictionary whose values should be used as</span>
<span class="sd">                    values for the y-axis, i.e. the dependent variable</span>
<span class="sd">          :conditions:   A list of functions that need to be fulfilled in order to</span>
<span class="sd">                         use one entry in the plot. Each function has to take two </span>
<span class="sd">                         arguments: The data dictionary containing all entries and</span>
<span class="sd">                         the index of the entry that should be checked. Each condition</span>
<span class="sd">                         must return a boolean value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="s">&#39;brown&#39;</span><span class="p">,</span> <span class="s">&#39;gray&#39;</span><span class="p">])</span>
        <span class="n">linestyles</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s">&#39;-&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">9</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;--&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">9</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;:&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">9</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;-.&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x_key</span><span class="p">])):</span>
            <span class="c"># Check is this particular entry should be used </span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">condition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">conditions</span><span class="p">):</span>
                <span class="k">continue</span>
    
            <span class="c"># Get the value of the independent variable for this entry</span>
            <span class="n">x_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>       
            <span class="c"># Attach the corresponding value to the respective partition</span>
            <span class="k">if</span> <span class="n">y_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">y_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">y_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># A weighted cost function</span>
                <span class="n">weight1</span><span class="p">,</span> <span class="n">value_key1</span><span class="p">,</span> <span class="n">weight2</span><span class="p">,</span> <span class="n">value_key2</span> <span class="o">=</span> <span class="n">y_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                <span class="n">y_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> \
                                        <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> 

            <span class="n">curves</span><span class="p">[</span><span class="n">y_key</span><span class="p">][</span><span class="n">x_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_value</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">y_key</span><span class="p">,</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">curves</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">curve_x</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">curve_y</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_values</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()):</span>
                <span class="n">curve_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_value</span><span class="p">)</span>
                <span class="n">curve_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>

            <span class="c"># Create an error bar plot </span>
            <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">curve_x</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">curve_y</span><span class="p">),</span> 
                          <span class="n">yerr</span><span class="o">=</span><span class="nb">map</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sem</span><span class="p">,</span> <span class="n">curve_y</span><span class="p">),</span>
                          <span class="n">elinewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">capsize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">y_key</span><span class="p">,</span>
                          <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyles</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>

        <span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_key</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">y_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">+</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">y_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)))</span>

        <span class="c"># Return figure name</span>
        <span class="k">return</span> <span class="s">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">y_key</span><span class="p">,</span> <span class="n">x_key</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="PerformanceResultSummary.plot_numeric_vs_numeric"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.plot_numeric_vs_numeric">[docs]</a>    <span class="k">def</span> <span class="nf">plot_numeric_vs_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">axis_keys</span><span class="p">,</span> <span class="n">value_key</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Contour plot of the value_key for the two numeric parameters axis_keys.</span>
<span class="sd">    </span>
<span class="sd">        A function that allows to create a contour plot that visualizes the effect </span>
<span class="sd">        of differing two variables on a third one (e.g. the effect of differing </span>
<span class="sd">        the lower and upper cutoff frequency of a bandpass filter onto</span>
<span class="sd">        the accuracy). </span>
<span class="sd">        </span>
<span class="sd">        **Parameters**</span>
<span class="sd">        </span>
<span class="sd">          :axes: The axes into which the plot is written</span>
<span class="sd">          :axis_keys: The two keys of the dictionary that are assumed to have \ </span>
<span class="sd">                      an effect on a third variable (the dependent variable)</span>
<span class="sd">          :value_key: The dependent variables whose values determine the \ </span>
<span class="sd">                      color of the contour plot</span>

<span class="sd">          :scatter: Plot nearly invisible dots behind the real data points.</span>
<span class="sd">          </span>
<span class="sd">                  (*optional, default: True*)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">axis_keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="c"># Determine a sorted list of the values taken on by the axis keys:</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>
        
        <span class="n">y_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_values</span><span class="p">))</span>
        <span class="c">#Done</span>
        
        <span class="c"># We cannot create a contour plot if one dimension is only 1d</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="c"># Create a meshgrid of them    </span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">)</span>
        <span class="c"># Determine the average value taken on by the dependent variable</span>
        <span class="c"># for each combination of the the two source variables</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">)))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]])):</span>
            <span class="n">x_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">y_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">])</span>
            
            <span class="k">if</span> <span class="n">value_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># A weighted cost function</span>
                <span class="n">weight1</span><span class="p">,</span> <span class="n">value_key1</span><span class="p">,</span> <span class="n">weight2</span><span class="p">,</span> <span class="n">value_key2</span> <span class="o">=</span> <span class="n">value_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> \
                                        <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> 
            
            <span class="n">Z</span><span class="p">[</span><span class="n">x_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x_value</span><span class="p">),</span> <span class="n">y_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">y_value</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">performance_value</span>
            <span class="n">counter</span><span class="p">[</span><span class="n">x_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x_value</span><span class="p">),</span> <span class="n">y_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">y_value</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">/</span> <span class="n">counter</span>
        
        <span class="c"># Create the plot for this specific dependent variable </span>
        <span class="n">cf</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scatter</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">,</span><span class="n">facecolors</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y_values</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_values</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">value_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">value_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">+</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)))</span>
        
        <span class="c"># Return figure name</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_vs_</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value_key</span><span class="p">,</span> <span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">),</span> <span class="n">axis_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        </div>
<div class="viewcode-block" id="PerformanceResultSummary.plot_numeric_vs_nominal"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.plot_numeric_vs_nominal">[docs]</a>    <span class="k">def</span> <span class="nf">plot_numeric_vs_nominal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">numeric_key</span><span class="p">,</span> <span class="n">nominal_key</span><span class="p">,</span> <span class="n">value_key</span><span class="p">,</span><span class="n">dependent_BA_plot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">relative_plot</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot for comparison of several different values of a nominal parameter</span>
<span class="sd">    </span>
<span class="sd">        A function that allows to create a plot that visualizes the effect of </span>
<span class="sd">        varying one numeric parameter onto the performance for several</span>
<span class="sd">        different values of a nominal parameter. </span>
<span class="sd">        </span>
<span class="sd">        **Parameters**</span>
<span class="sd">        </span>
<span class="sd">          :axes: The axes into which the plot is written  </span>
<span class="sd">          :numeric_key:   The numeric parameter whose effect (together with the</span>
<span class="sd">                          nominal parameter) onto the dependent variable should</span>
<span class="sd">                          be investigated.</span>
<span class="sd">          :nominal_key:   The nominal parameter whose effect (together with the</span>
<span class="sd">                          numeric parameter) onto the dependent variable should</span>
<span class="sd">                          be investigated. </span>
<span class="sd">          :value_key:    The dependent variable whose values determine the</span>
<span class="sd">                         color of the contour plot</span>
<span class="sd">          :dependent_BA_plot:  </span>
<span class="sd">                If the `value_key` contains *time* or *iterations*</span>
<span class="sd">                and this variable is True, the value is replaced by</span>
<span class="sd">                *Balanced_Accuracy* and the `nominal_key` by the `value_key`.</span>
<span class="sd">                The point in the graph are constructed by averaging</span>
<span class="sd">                over the old `nominal parameter`.</span>
<span class="sd">                </span>
<span class="sd">                (*optional, default: False*)</span>
<span class="sd">                </span>
<span class="sd">          :relative_plot:</span>
<span class="sd">                The first `nominal_key` value (alphabetic ordering) is chosen and the other</span>
<span class="sd">                parameters are averaged relative to this parameter, to show</span>
<span class="sd">                by which factor they change the metric.</span>
<span class="sd">                Therefore a clean tabular is needed with only relevant</span>
<span class="sd">                variables correctly named and where each parameter is compared</span>
<span class="sd">                with the other. Relative plots and dependent_BA plots can be combined.</span>

<span class="sd">                (*optional, default: False*)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">,</span>  <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="s">&#39;brown&#39;</span><span class="p">,</span> <span class="s">&#39;gray&#39;</span><span class="p">,</span><span class="s">&#39;orange&#39;</span><span class="p">])</span>
        <span class="n">linestyles</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s">&#39;-&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;-.&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;:&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;--&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">eps</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
        <span class="c"># Determine a mapping from the value of the nominal value to a mapping</span>
        <span class="c"># from the value of the numeric value to the achieved performance:</span>
        <span class="c"># nominal -&gt; (numeric -&gt; performance)</span>
        <span class="k">if</span> <span class="p">((</span><span class="s">&quot;time&quot;</span> <span class="ow">in</span> <span class="n">value_key</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&quot;Time&quot;</span> <span class="ow">in</span> <span class="n">value_key</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&quot;iterations&quot;</span> <span class="ow">in</span> <span class="n">value_key</span><span class="p">))</span> <span class="ow">and</span> <span class="n">dependent_BA_plot</span><span class="p">:</span>
            <span class="n">dependent_key</span> <span class="o">=</span> <span class="n">value_key</span>
            <span class="n">value_key</span><span class="o">=</span><span class="s">&quot;Balanced_accuracy&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dependent_key</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">relative_plot</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">relative_plot</span><span class="p">:</span>
            <span class="n">rel_par</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nominal_key</span><span class="p">])))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">rel_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variables</span><span class="p">()</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nominal_key</span><span class="p">])):</span>
            <span class="n">curve_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nominal_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">parameter_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">numeric_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">value_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># A weighted cost function</span>
                <span class="n">weight1</span><span class="p">,</span> <span class="n">value_key1</span><span class="p">,</span> <span class="n">weight2</span><span class="p">,</span> <span class="n">value_key2</span> <span class="o">=</span> <span class="n">value_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> \
                                        <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">relative_plot</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">curve_key</span> <span class="o">==</span> <span class="n">rel_par</span><span class="p">:</span>
                    <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">performance_value</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">dependent_key</span><span class="p">:</span>
                        <span class="n">dependent_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">dependent_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rel_vars_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">rel_vars</span><span class="p">:</span>
                        <span class="n">rel_vars_dict</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">rel_vars_dict</span><span class="p">[</span><span class="n">nominal_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel_par</span>
                    <span class="n">rel_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_performance_entry</span><span class="p">(</span><span class="n">rel_vars_dict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">value_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">factor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rel_data</span><span class="p">[</span><span class="n">value_key</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">,</span><span class="n">e</span><span class="p">:</span>
                            <span class="k">print</span> <span class="n">rel_data</span>
                            <span class="k">print</span> <span class="n">value_key</span>
                            <span class="k">print</span> <span class="n">rel_vars_dict</span>
                            <span class="k">print</span> <span class="n">rel_vars_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                            <span class="k">raise</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span> <span class="c"># A weighted cost function</span>
                        <span class="n">weight1</span><span class="p">,</span> <span class="n">value_key1</span><span class="p">,</span> <span class="n">weight2</span><span class="p">,</span> <span class="n">value_key2</span> <span class="o">=</span> <span class="n">value_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                        <span class="n">factor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">rel_data</span><span class="p">[</span><span class="n">value_key1</span><span class="p">])</span> \
                                                <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">rel_data</span><span class="p">[</span><span class="n">value_key2</span><span class="p">])</span>
                    <span class="n">dependent_factor</span> <span class="o">=</span> <span class="n">rel_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dependent_key</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">dependent_factor</span>  <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">dependent_factor</span> <span class="o">=</span> <span class="n">eps</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Dependent key </span><span class="si">%s</span><span class="s"> got zero value in reference </span><span class="si">%s</span><span class="s">.&quot;</span><span class="o">%</span><span class="p">(</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">dependent_key</span><span class="p">),</span><span class="n">rel_par</span>
                            <span class="p">))</span>
                    <span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">factor</span> <span class="o">=</span> <span class="n">eps</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Value key </span><span class="si">%s</span><span class="s"> got zero value in reference </span><span class="si">%s</span><span class="s">.&quot;</span><span class="o">%</span><span class="p">(</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">value_key</span><span class="p">),</span><span class="n">rel_par</span>
                            <span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">factor</span> <span class="o">=</span>  <span class="mi">1</span>
                <span class="n">dependent_factor</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">dependent_key</span><span class="p">:</span>
                <span class="n">curves</span><span class="p">[</span><span class="n">curve_key</span><span class="p">][</span><span class="n">parameter_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">performance_value</span><span class="o">/</span><span class="n">factor</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">curves</span><span class="p">[</span><span class="n">curve_key</span><span class="p">][</span><span class="n">parameter_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">performance_value</span><span class="o">/</span><span class="n">factor</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">dependent_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">dependent_factor</span><span class="p">)))</span>
        
        <span class="c"># Iterate over all values of the nominal parameter and create one curve</span>
        <span class="c"># in the plot showing the mapping from numeric parameter to performance </span>
        <span class="c"># for this particular value of the nominal parameter</span>
        <span class="k">for</span> <span class="n">curve_key</span><span class="p">,</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">curves</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">x_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">y_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">y_errs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">x_errs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">dependent_key</span><span class="p">:</span>
                    <span class="n">x_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_value</span><span class="p">)</span>
                    <span class="c"># Plot the mean of all values of the performance for this </span>
                    <span class="c"># particular combination of nominal and numeric parameter</span>
                    <span class="n">y_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pylab</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_value</span><span class="p">))</span>
                    <span class="n">y_errs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">y_value</span><span class="p">))</span>
                    <span class="n">x_errs</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c"># calculate mean and standard deviation</span>
                    <span class="c"># of metric and dependent parameter values and</span>
                    <span class="c"># use the dependent parameter as x_value</span>
                    <span class="c"># and the metric as y_value</span>
                    <span class="n">mean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_value</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">metric_mean</span> <span class="o">=</span> <span class="n">mean</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">time_mean</span> <span class="o">=</span> <span class="n">mean</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">sem</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">y_value</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">metric_sem</span> <span class="o">=</span> <span class="n">sem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">time_sem</span> <span class="o">=</span> <span class="n">sem</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">x_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_mean</span><span class="p">)</span>
                    <span class="n">y_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric_mean</span><span class="p">)</span>
                    <span class="n">x_errs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_sem</span><span class="p">)</span>
                    <span class="n">y_errs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric_sem</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">101</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">xerr</span> <span class="o">=</span> <span class="n">x_errs</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">y_errs</span><span class="p">,</span> 
                          <span class="n">label</span><span class="o">=</span><span class="n">curve_key</span><span class="p">,</span> 
                          <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyles</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span>
                          <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="n">xerr</span> <span class="o">=</span> <span class="n">x_errs</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">y_errs</span><span class="p">,</span> 
                          <span class="n">label</span><span class="o">=</span><span class="n">curve_key</span><span class="p">,</span> 
                          <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyles</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span>
                          <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span><span class="n">capsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dependent_key</span><span class="p">:</span>
            <span class="n">numeric_key</span> <span class="o">=</span> <span class="n">dependent_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; averaged dependent on &quot;</span> <span class="o">+</span> <span class="n">numeric_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">numeric_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">relative_plot</span><span class="p">:</span>
            <span class="n">value_key</span> <span class="o">=</span> <span class="n">value_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; relative to &quot;</span><span class="o">+</span> <span class="n">rel_par</span>
        <span class="k">if</span> <span class="n">value_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">value_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">+</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)))</span>
            
        <span class="n">prop</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s">&#39;xx-small&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nominal_key</span><span class="o">==</span><span class="s">&quot;None&quot;</span><span class="p">:</span>
            <span class="n">lg</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="n">prop</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fancybox</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">nominal_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">))</span>
            <span class="n">lg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">&#39;0.90&#39;</span><span class="p">)</span>
            <span class="n">lg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
        <span class="c"># axes.set_xscale(&#39;log&#39;)</span>
        <span class="c"># Return figure name</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_vs_</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value_key</span><span class="p">,</span> <span class="n">nominal_key</span><span class="p">,</span> <span class="n">numeric_key</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.plot_nominal"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.plot_nominal">[docs]</a>    <span class="k">def</span> <span class="nf">plot_nominal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">x_key</span><span class="p">,</span> <span class="n">y_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a boxplot of the y_key for the given nominal parameter x_key.</span>
<span class="sd">        </span>
<span class="sd">        A function that allows to create a plot that visualizes the effect </span>
<span class="sd">        of differing one nominal variable onto a second one (e.g. the effect of  </span>
<span class="sd">        differing the classifier onto the accuracy). </span>
<span class="sd">        </span>
<span class="sd">        **Expected arguments**</span>
<span class="sd">        </span>
<span class="sd">          :axes: The axes into which the plot is written</span>
<span class="sd">          :x_key: The key of the dictionary whose values should be used as</span>
<span class="sd">                    values for the x-axis (the independent variables)</span>
<span class="sd">          :y_key: The key of the dictionary whose values should be used as</span>
<span class="sd">                    values for the y-axis, i.e. the dependent variable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Create the plot for this specific dependent variable </span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x_key</span><span class="p">])):</span>
            <span class="n">parameter_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">y_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">y_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># A weighted cost function</span>
                <span class="n">weight1</span><span class="p">,</span> <span class="n">y_key1</span><span class="p">,</span> <span class="n">weight2</span><span class="p">,</span> <span class="n">y_key2</span> <span class="o">=</span> <span class="n">y_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">y_key1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> \
                                        <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">y_key2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> 
                
            <span class="n">values</span><span class="p">[</span><span class="n">parameter_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">performance_value</span><span class="p">)</span>
        
        <span class="n">values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        
        <span class="c"># the bottom of the subplots of the figure</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">values</span><span class="p">))</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">))</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="s">&#39;x-small&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">y_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">+</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">y_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)))</span>
      
        <span class="c"># Return figure name   </span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">y_key</span><span class="p">,</span> <span class="n">x_key</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PerformanceResultSummary.plot_nominal_vs_nominal"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.plot_nominal_vs_nominal">[docs]</a>    <span class="k">def</span> <span class="nf">plot_nominal_vs_nominal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">nominal_key1</span><span class="p">,</span> <span class="n">nominal_key2</span><span class="p">,</span> <span class="n">value_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot comparison of several different values of two nominal parameters</span>
<span class="sd">        </span>
<span class="sd">        A function that allows to create a plot that visualizes the effect of</span>
<span class="sd">        varying one nominal parameter onto the performance for several</span>
<span class="sd">        different values of another nominal parameter.</span>
<span class="sd">        </span>
<span class="sd">        **Expected arguments**</span>
<span class="sd">        </span>
<span class="sd">          :axes: The axes into which the plot is written</span>
<span class="sd">          :nominal_key1:   The name of the first nominal parameter whose effect</span>
<span class="sd">                           shall be investigated. This parameter determines the</span>
<span class="sd">                           x-axis.</span>
<span class="sd">          :nominal_key2:   The second nominal parameter. This parameter will be</span>
<span class="sd">                           represented by a different color per value.</span>
<span class="sd">          :value_key:    The name of the dependent variable whose values</span>
<span class="sd">                         determines the y-values in the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">Rectangle</span>
        <span class="c"># boxColors = [&#39;b&#39;,&#39;r&#39;, &#39;g&#39;,  &#39;c&#39;, &#39;m&#39;, &#39;y&#39;, &#39;k&#39;, &#39;brown&#39;, &#39;gray&#39;]</span>
        <span class="n">boxColors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;steelblue&#39;</span><span class="p">,</span><span class="s">&#39;burlywood&#39;</span><span class="p">,</span> <span class="s">&#39;crimson&#39;</span><span class="p">,</span> <span class="s">&#39;olive&#39;</span><span class="p">,</span> <span class="s">&#39;cadetblue&#39;</span><span class="p">,</span>
                     <span class="s">&#39;cornflowerblue&#39;</span><span class="p">,</span>  <span class="s">&#39;darkgray&#39;</span><span class="p">,</span> <span class="s">&#39;darkolivegreen&#39;</span><span class="p">,</span>
                     <span class="s">&#39;goldenrod&#39;</span><span class="p">,</span> <span class="s">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="s">&#39;lightsalmon&#39;</span><span class="p">,</span> <span class="s">&#39;lightseagreen&#39;</span><span class="p">,</span>
                     <span class="s">&#39;lightskyblue&#39;</span><span class="p">,</span> <span class="s">&#39;lightslategray&#39;</span><span class="p">,</span> <span class="s">&#39;mediumseagreen&#39;</span><span class="p">,</span>
                     <span class="s">&#39;mediumturquoise&#39;</span><span class="p">,</span> <span class="s">&#39;mediumvioletred&#39;</span><span class="p">,</span> <span class="s">&#39;navy&#39;</span><span class="p">,</span> <span class="s">&#39;orange&#39;</span><span class="p">,</span>
                     <span class="s">&#39;tan&#39;</span><span class="p">,</span> <span class="s">&#39;teal&#39;</span><span class="p">,</span> <span class="s">&#39;yellowgreen&#39;</span><span class="p">]</span>
        
        <span class="c"># Gathering of the data</span>
        <span class="n">plot_data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nominal_key2</span><span class="p">])):</span>
            <span class="n">nom1_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nominal_key1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">nom2_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">nominal_key2</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># A weighted cost function</span>
                <span class="n">weight1</span><span class="p">,</span> <span class="n">value_key1</span><span class="p">,</span> <span class="n">weight2</span><span class="p">,</span> <span class="n">value_key2</span> <span class="o">=</span> <span class="n">value_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                <span class="n">performance_value</span> <span class="o">=</span> \
                            <span class="nb">float</span><span class="p">(</span><span class="n">weight1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> \
                             <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">value_key2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                
            <span class="n">plot_data</span><span class="p">[</span><span class="n">nom1_key</span><span class="p">][</span><span class="n">nom2_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">performance_value</span><span class="p">)</span>
        
        <span class="c"># Prepare data for boxplots</span>
        <span class="n">box_data</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">nom1_keys</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">nom1_key</span><span class="p">,</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">x_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">y_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">nom1_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nom1_key</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_values</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()):</span>
                <span class="n">box_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
        
        <span class="c"># Make sure we always have enough colors available</span>
        <span class="n">nom2_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">plot_data</span><span class="p">[</span><span class="n">nom1_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">boxColors</span><span class="p">):</span>
            <span class="n">boxColors</span><span class="o">+=</span><span class="n">boxColors</span>
        
        <span class="c"># the bottom of the subplots of the figure</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
        <span class="c"># position the boxes in the range of +-0.25 around {1,2,3,...}</span>
        <span class="n">box_positions</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom1_keys</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">box_positions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">-.</span><span class="mi">25</span> <span class="o">+</span> <span class="n">a</span><span class="o">*.</span><span class="mi">5</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                                          <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">))])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">box_positions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="c"># actual plotting; width of the boxes:</span>
        <span class="n">w</span><span class="o">=.</span><span class="mi">5</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="o">.</span><span class="mi">35</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bp</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">box_data</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">box_positions</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
        <span class="c"># design of boxplot components</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s">&#39;boxes&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s">&#39;whiskers&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">bp</span><span class="p">[</span><span class="s">&#39;fliers&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;grey&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="c"># use the nom1 keys as x-labels</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom1_keys</span><span class="p">))],</span> <span class="n">minor</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">nom1_keys</span><span class="p">)</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="s">&#39;x-small&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">nominal_key1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        
        <span class="c"># Now fill the boxes with desired colors by superposing polygons</span>
        <span class="n">numBoxes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nom1_keys</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span>
        <span class="n">medians</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">numBoxes</span><span class="p">)</span>
        <span class="c"># get all box coordinates</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numBoxes</span><span class="p">):</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s">&#39;boxes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">boxX</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">boxY</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                <span class="n">boxX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">boxY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">boxCoords</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">boxX</span><span class="p">,</span><span class="n">boxY</span><span class="p">)</span>
            <span class="c"># cycle through predefined colors</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span>
            <span class="c"># draw polygon</span>
            <span class="n">boxPolygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">boxCoords</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">boxColors</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">boxPolygon</span><span class="p">)</span>
            <span class="c"># Now draw the median lines back over what we just filled in</span>
            <span class="n">med</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s">&#39;medians&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">medianX</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">medianY</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">medianX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">med</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">medianY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">med</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">medianX</span><span class="p">,</span> <span class="n">medianY</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">)</span>
                <span class="n">medians</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">medianY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
        <span class="c"># Draw a legend by hand. As the legend is hand made, it is not easily</span>
        <span class="c"># possible to change it&#39;s location or size - sorry for inconvenience.</span>
        <span class="c"># width of the axes and xy-position of legend element #offset</span>
        <span class="n">dxy</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
               <span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">offset</span><span class="p">:</span> <span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">8</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                             <span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mo">03</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                                <span class="o">+</span> <span class="o">.</span><span class="mo">05</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">offset</span><span class="p">]</span>
        <span class="c"># Background rectangle for the legend.</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">xy</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">-.</span><span class="mo">02</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">-.</span><span class="mo">02</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                         <span class="o">.</span><span class="mi">2</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="o">.</span><span class="mo">05</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mf">0.0175</span><span class="p">)</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                         <span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;0.9&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="c"># legend &quot;title&quot;</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">+.</span><span class="mo">03</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span><span class="o">+.</span><span class="mo">005</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                  <span class="n">nominal_key2</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">),</span>
                  <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s">&#39;roman&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&#39;small&#39;</span><span class="p">)</span>

        <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
        <span class="c"># rect and text for each nom2-Value</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)):</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="p">(</span><span class="n">key</span><span class="p">),</span><span class="o">.</span><span class="mo">05</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">.</span><span class="mo">035</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                             <span class="n">facecolor</span><span class="o">=</span><span class="n">boxColors</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="p">(</span><span class="n">key</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+.</span><span class="mo">06</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">(</span><span class="n">key</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">+.</span><span class="mo">005</span><span class="o">*</span><span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                      <span class="n">nom2_keys</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nom2_keys</span><span class="p">)</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                      <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s">&#39;roman&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&#39;small&#39;</span><span class="p">)</span>
        
        <span class="c"># Add a horizontal grid to the plot</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s">&#39;major&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;lightgrey&#39;</span><span class="p">,</span>
                          <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">value_key</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">value_key</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">+</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)))</span>
        
        <span class="c"># Return figure name</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_vs_</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value_key</span><span class="p">,</span> <span class="n">nominal_key1</span><span class="p">,</span> <span class="n">nominal_key2</span><span class="p">)</span>
        
    </div>
<div class="viewcode-block" id="PerformanceResultSummary.plot_histogram"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary.plot_histogram">[docs]</a>    <span class="k">def</span> <span class="nf">plot_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">numeric_parameters</span><span class="p">,</span> <span class="n">nominal_parameters</span><span class="p">,</span>
                       <span class="n">average_runs</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plots a histogram of the values the given metric takes on in data</span>
<span class="sd">         </span>
<span class="sd">        Plots histogram for *metric* in which each parameter combination from </span>
<span class="sd">        *numeric_paramerters* and *nominal_parameters* corresponds</span>
<span class="sd">        to one value (if *average_runs* == True) or each run corresponds</span>
<span class="sd">        to one value ((if *average_runs* == False).</span>
<span class="sd">        The plot is written into *axes*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">average_runs</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">metric_values</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">metric</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Merge all parameters in one list</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">numeric_parameters</span><span class="p">)</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nominal_parameters</span><span class="p">)</span>
            
            <span class="c"># Sort metric values according to the parameterization for the</span>
            <span class="c"># specific value</span>
            <span class="n">all_values</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">metric</span><span class="p">])):</span>
                <span class="n">key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">)</span>
                <span class="n">all_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">metric</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
            
            <span class="c"># Combine the mean value of the metric for each parameter </span>
            <span class="c"># combination</span>
            <span class="n">metric_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> 
                                    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">all_values</span><span class="o">.</span><span class="n">itervalues</span><span class="p">()]</span>
        
        <span class="c"># Plot and store the histogram</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">metric_values</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">pylab</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">metric</span> <span class="k">if</span> <span class="n">average_runs</span> <span class="o">==</span> <span class="bp">False</span> 
                        <span class="k">else</span> <span class="s">&quot;Mean </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">metric</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Occurrences&#39;</span><span class="p">)</span>
        
        <span class="c"># Return figure name</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_histogram&quot;</span> <span class="o">%</span> <span class="n">metric</span>


<span class="c">###############################################################################</span>

</div></div>
<div class="viewcode-block" id="ROCCurves"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.ROCCurves">[docs]</a><span class="k">class</span> <span class="nc">ROCCurves</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class for plotting ROC curves &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="ROCCurves.__init__"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.ROCCurves.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roc_curves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_all_curves</span><span class="p">(</span><span class="n">base_path</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="s">&#39;brown&#39;</span><span class="p">,</span> <span class="s">&#39;gray&#39;</span><span class="p">])</span>  
        </div>
<div class="viewcode-block" id="ROCCurves.is_empty"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.ROCCurves.is_empty">[docs]</a>    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return whether there are no loaded ROC curves &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roc_curves</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</div>
<div class="viewcode-block" id="ROCCurves.plot"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.ROCCurves.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">selected_variable</span><span class="p">,</span> <span class="n">projection_parameter</span><span class="p">,</span> <span class="n">fpcost</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
             <span class="n">fncost</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># Draw cost grid into the background</span>
        <span class="k">for</span> <span class="n">cost</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">fpcost</span><span class="o">+</span><span class="n">fncost</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">cost</span><span class="o">/</span><span class="n">fncost</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">cost</span><span class="o">-</span><span class="n">fpcost</span><span class="p">)</span><span class="o">/</span><span class="n">fncost</span><span class="p">],</span>
                      <span class="n">c</span><span class="o">=</span><span class="s">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            
<span class="c">#        # If we do not average:</span>
<span class="c">#        if selected_variable == None:</span>
<span class="c">#            # Delegate to plot_all method</span>
<span class="c">#            return self.plot_all(axis, projection_parameter, collection)</span>
        
        <span class="c"># Draw an additional &quot;axis&quot; (the identity) to show skew/centroid of</span>
        <span class="c"># ROC curves</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">k</span><span class="o">+</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mf">0.01</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="c"># Create a color dict</span>
        <span class="n">color_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
        
        <span class="c"># Some helper function</span>
        <span class="k">def</span> <span class="nf">create_roc_function</span><span class="p">(</span><span class="n">roc_curve</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Create a function mapping FPR onto TPR for the given roc_curve &quot;&quot;&quot;</span>
            <span class="k">def</span> <span class="nf">roc_function</span><span class="p">(</span><span class="n">query_fpr</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot; Map FPR onto TPR using linear interpolation on ROC curve.&quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">query_fpr</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span> <span class="k">return</span> <span class="mf">0.0</span> <span class="c"># Avoid division by zero</span>
                <span class="n">last_fpr</span><span class="p">,</span> <span class="n">last_tpr</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
                <span class="k">for</span> <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span> <span class="ow">in</span> <span class="n">roc_curve</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fpr</span> <span class="o">&gt;=</span> <span class="n">query_fpr</span><span class="p">:</span>
                        <span class="k">return</span> <span class="p">(</span><span class="n">query_fpr</span> <span class="o">-</span> <span class="n">last_fpr</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">fpr</span> <span class="o">-</span> <span class="n">last_fpr</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">tpr</span> <span class="o">-</span> <span class="n">last_tpr</span><span class="p">)</span> <span class="o">+</span> <span class="n">last_tpr</span>
                    <span class="n">last_fpr</span><span class="p">,</span> <span class="n">last_tpr</span> <span class="o">=</span> <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span>
                <span class="k">return</span> <span class="n">tpr</span>

            <span class="k">return</span> <span class="n">roc_function</span>
        
        <span class="k">def</span> <span class="nf">create_weight_function</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">mean_curve</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">            Creates a function that computes the orthogonal distance of the ROC</span>
<span class="sd">            curve from the identity axis at an arbitrary (k,k)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">def</span> <span class="nf">weight_function</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">                Creates a function that computes the orthogonal distance of the </span>
<span class="sd">                ROC curve from the identity axis at (k,k) </span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span> <span class="k">return</span> <span class="mf">0.0</span> <span class="c"># Avoid division by zero</span>
                <span class="k">for</span> <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">mean_curve</span><span class="p">):</span>
                    <span class="k">if</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">fpr</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">tpr</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">:</span>
                        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">fpr</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">tpr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                <span class="k">return</span> <span class="mf">0.0</span>

            <span class="k">return</span> <span class="n">weight_function</span>
        
        <span class="c"># Create mapping parameterization -&gt; ROC functions</span>
        <span class="n">roc_fct_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">parametrization</span><span class="p">,</span> <span class="n">roc_curve</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_onto_subset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roc_curves</span><span class="p">,</span> 
                                                                    <span class="n">projection_parameter</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">parametrization</span><span class="p">[</span><span class="n">selected_variable</span><span class="p">]</span> <span class="k">if</span> <span class="n">selected_variable</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">selected_variable</span> <span class="ow">in</span> <span class="n">parametrization</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="s">&quot;Global&quot;</span>
            <span class="n">roc_fct_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_roc_function</span><span class="p">(</span><span class="n">roc_curve</span><span class="p">))</span>
            
        <span class="c"># Iterate over all parametrization and average ROC functions and compute</span>
        <span class="c"># centroid</span>
        <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">roc_fcts</span> <span class="ow">in</span> <span class="n">roc_fct_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">x_values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
            <span class="n">roc_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_values</span><span class="p">:</span>
                <span class="n">roc_values</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">roc_fct</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">roc_fct</span> <span class="ow">in</span> <span class="n">roc_fcts</span><span class="p">])</span>
            
            <span class="n">mean_curve</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">roc_values</span><span class="p">)</span>
            
            <span class="c"># Compute centroid of the mean ROC curve over the identity axis</span>
            <span class="n">weight_fct</span> <span class="o">=</span> <span class="n">create_weight_function</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">mean_curve</span><span class="p">)</span>

            <span class="n">k_values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">weight_fct</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span>
            <span class="n">centroid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k_values</span><span class="p">)))</span> \
                                <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
                                             
            <span class="k">if</span> <span class="n">selected_variable</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">color_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>

            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">mean_curve</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x_values</span><span class="p">[::</span><span class="mi">25</span><span class="p">],</span> <span class="n">mean_curve</span><span class="p">[::</span><span class="mi">25</span><span class="p">],</span>
                          <span class="n">yerr</span><span class="o">=</span><span class="nb">map</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sem</span><span class="p">,</span> <span class="n">roc_values</span><span class="p">)[::</span><span class="mi">25</span><span class="p">],</span>
                          <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">)</span>

            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">centroid</span><span class="p">],</span> <span class="p">[</span><span class="n">centroid</span><span class="p">],</span> 
                      <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;h&#39;</span><span class="p">)</span>
                    
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;False positive rate&quot;</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;True positive rate&quot;</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selected_variable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">selected_variable</span><span class="p">))</span>

        </div>
<div class="viewcode-block" id="ROCCurves.plot_all"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.ROCCurves.plot_all">[docs]</a>    <span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">projection_parameter</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot all loaded ROC curves after projecting onto subset. &quot;&quot;&quot;</span>
        <span class="c"># Iterate over all ROC curves for parametrization that are selected</span>
        <span class="c"># by projection_parameter.</span>
        <span class="k">for</span> <span class="n">parametrization</span><span class="p">,</span> <span class="n">roc_curve</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_onto_subset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roc_curves</span><span class="p">,</span> 
                                                                    <span class="n">projection_parameter</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
                           
            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">roc_curve</span><span class="p">),</span> <span class="nb">map</span><span class="p">(</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">roc_curve</span><span class="p">),</span>
                      <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            
<span class="c">#            fpr = eval(collection.data[&#39;False_positive_rate&#39;][0])</span>
<span class="c">#            tpr = eval(collection.data[&#39;True_positive_rate&#39;][0])</span>
<span class="c">#            axis.scatter([fpr], [tpr], c=&#39;k&#39;, s=50)</span>
        
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&quot;False positive rate&quot;</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;True positive rate&quot;</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                   </div>
<div class="viewcode-block" id="ROCCurves._load_all_curves"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.ROCCurves._load_all_curves">[docs]</a>    <span class="k">def</span> <span class="nf">_load_all_curves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Load all ROC curves located in the persistency dirs below *dir* &quot;&quot;&quot;</span>
        <span class="n">all_roc_curves</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subdir</span> <span class="ow">in</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span> 
                                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">name</span><span class="p">))]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">subdir</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;{&quot;</span><span class="p">):</span> <span class="k">continue</span>
            <span class="n">parametrization</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">tokens</span> <span class="o">=</span> <span class="n">subdir</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;}{&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;}{&quot;</span><span class="p">)</span>
            <span class="n">parametrization</span><span class="p">[</span><span class="s">&quot;__Dataset__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="c"># TODO if anything else then node chain template has no # this will fail;</span>
                <span class="c"># delete as soon as no more data with node chain templates in folder names</span>
                <span class="c"># circulate</span>
                <span class="k">if</span> <span class="s">&#39;#&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">token</span><span class="p">:</span>
                    <span class="n">parametrization</span><span class="p">[</span><span class="s">&quot;__Template__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">token</span>
                    <span class="k">continue</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="n">parametrization</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                           
            <span class="k">for</span> <span class="n">run_dir</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">subdir</span> 
                                     <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;persistency_run*&quot;</span><span class="p">):</span>
                <span class="n">run</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">run_dir</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;persistency_run&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">split_file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">run_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;PerformanceSinkNode&quot;</span>
                                            <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;roc_points_sp*.pickle&quot;</span><span class="p">):</span>
                    <span class="n">split</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">split_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;roc_points_sp&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&quot;.pickle&quot;</span><span class="p">))</span>
                    <span class="n">rs_parametrization</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">parametrization</span><span class="p">)</span>
                    <span class="n">rs_parametrization</span><span class="p">[</span><span class="s">&quot;__Key_Run__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span>
                    <span class="n">rs_parametrization</span><span class="p">[</span><span class="s">&quot;__Run__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;__Run_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>
                    <span class="n">rs_parametrization</span><span class="p">[</span><span class="s">&quot;__Key_Fold__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split</span>
                    <span class="n">rs_parametrization</span><span class="p">[</span><span class="s">&quot;__Split__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;__Split_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">split</span><span class="p">)</span>
                    
                    <span class="n">roc_curves</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">split_file</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">))</span>
                    
                    <span class="n">all_roc_curves</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rs_parametrization</span><span class="p">,</span> <span class="n">roc_curves</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    
        <span class="k">return</span> <span class="n">all_roc_curves</span>
    </div>
<div class="viewcode-block" id="ROCCurves._project_onto_subset"><a class="viewcode-back" href="../../../../api/generated/pySPACE.resources.dataset_defs.performance_result.html#pySPACE.resources.dataset_defs.performance_result.ROCCurves._project_onto_subset">[docs]</a>    <span class="k">def</span> <span class="nf">_project_onto_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roc_curves</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retain only roc_curves that fulfill the given constraints. &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">parametrization</span><span class="p">,</span> <span class="n">roc_curve</span> <span class="ow">in</span> <span class="n">roc_curves</span><span class="p">:</span>
            <span class="c"># Check constraints</span>
            <span class="n">constraints_fulfilled</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">for</span> <span class="n">constraint_key</span><span class="p">,</span> <span class="n">constraint_value</span> <span class="ow">in</span> <span class="n">constraints</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">constraint_key</span> <span class="ow">in</span> <span class="n">parametrization</span> \
                         <span class="ow">or</span> <span class="n">parametrization</span><span class="p">[</span><span class="n">constraint_key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">constraint_value</span><span class="p">:</span>
                    <span class="n">constraints_fulfilled</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">constraints_fulfilled</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">parametrization</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">)</span>
</pre></div></div></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">pySPACE 0.5 alpha documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, pySPACE Developer Team.
      Last updated on Aug 07, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>