

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pySPACE.missions.operations.comp_analysis &mdash; pySPACE 0.5 alpha documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/pySPACE.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.5 alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../../_static/pyspace-logo.ico"/>
    <link rel="top" title="pySPACE 0.5 alpha documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">pySPACE 0.5 alpha documentation</a> &raquo;</li>
          <li><a href="../../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/pyspace-logo_small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pySPACE.missions.operations.comp_analysis</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot; Creates various comparing plots on several levels for a :class:`~pySPACE.resources.dataset_defs.performance_result.PerformanceResultSummary`</span>

<span class="sd">This module contains implementations of an operation and</span>
<span class="sd">a process for analyzing data contained in a csv file (typically the result</span>
<span class="sd">of a Weka Classification Operation).</span>

<span class="sd">A *CompAnalysisProcess* consists of evaluating the effect of several parameter</span>
<span class="sd">on a set of metrics. For each numeric parameter, each pair of numeric parameters</span>
<span class="sd">and each nominal parameter, one plot is created for each metric.</span>

<span class="sd">Furthermore, for each value of each parameter, the rows of the data where</span>
<span class="sd">the specific parameter takes on the specific value are selected and the same</span>
<span class="sd">analysis is done for this subset recursively.</span>

<span class="sd">This is useful for large experiments where several parameters are differed.</span>
<span class="sd">For instance, if one wants to analyze how the performance is for certain</span>
<span class="sd">settings of certain parameters, on can get all plots in the respective</span>
<span class="sd">subdirectories. For instance, if one is interested only in the performance</span>
<span class="sd">of one classifier, on can go into the subdirectory of the respective classifier.</span>

<span class="sd">The &quot;Comp Analysis Operation&quot; is similar to the &quot;Analysis Operation&quot;; the only</span>
<span class="sd">difference is that plots corresponding to the same parameters but different</span>
<span class="sd">metrics are created in one single pdf file. This ensures better comparability</span>
<span class="sd">and lower computation time, as less files are created.</span>

<span class="sd">.. todo:: Unification with analysis operation to prevent from doubled code</span>
<span class="sd">.. todo:: correct parameter documentation</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">processing</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="kn">as</span> <span class="nn">processing</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">matplotlib.font_manager</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">pySPACE.tools.filesystem</span> <span class="kn">import</span> <span class="n">create_directory</span>
<span class="kn">from</span> <span class="nn">pySPACE.resources.dataset_defs.base</span> <span class="kn">import</span> <span class="n">BaseDataset</span>

<span class="kn">import</span> <span class="nn">pySPACE</span>
<span class="kn">from</span> <span class="nn">pySPACE.missions.operations.base</span> <span class="kn">import</span> <span class="n">Operation</span><span class="p">,</span> <span class="n">Process</span>


<div class="viewcode-block" id="CompAnalysisOperation"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisOperation">[docs]</a><span class="k">class</span> <span class="nc">CompAnalysisOperation</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Operation for analyzing and plotting data in compressed format</span>
<span class="sd">    </span>
<span class="sd">    A *CompAnalysisOperation* is similar to a *AnalysisOperation*:</span>
<span class="sd">    </span>
<span class="sd">    An *AnalysisOperation* loads the data from a csv-file (typically the result</span>
<span class="sd">    of a Weka Classification Operation) and evaluates the effect of various</span>
<span class="sd">    parameters on several metrics.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CompAnalysisOperation.__init__"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisOperation.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">processes</span><span class="p">,</span> <span class="n">operation_spec</span><span class="p">,</span> <span class="n">result_directory</span><span class="p">,</span>
                   <span class="n">number_processes</span><span class="p">,</span> <span class="n">create_process</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span> <span class="n">CompAnalysisOperation</span><span class="p">,</span> <span class="bp">self</span> <span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span> <span class="n">processes</span><span class="p">,</span>
                                             <span class="n">operation_spec</span><span class="p">,</span> <span class="n">result_directory</span> <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">operation_spec</span> <span class="o">=</span> <span class="n">operation_spec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_process</span> <span class="o">=</span> <span class="n">create_process</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_processes</span> <span class="o">=</span> <span class="n">number_processes</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="CompAnalysisOperation.create"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisOperation.create">[docs]</a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">operation_spec</span><span class="p">,</span> <span class="n">result_directory</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">input_paths</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A factory method that creates an Analysis operation based on the</span>
<span class="sd">        information given in the operation specification operation_spec.</span>
<span class="sd">        If debug is TRUE the creation of the Analysis Processes will not</span>
<span class="sd">        be in a separated thread.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">operation_spec</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;comp_analysis&quot;</span><span class="p">)</span>
        <span class="n">input_path</span> <span class="o">=</span> <span class="n">operation_spec</span><span class="p">[</span><span class="s">&quot;input_path&quot;</span><span class="p">]</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="n">BaseDataset</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pySPACE</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">storage</span><span class="p">,</span>
                                      <span class="n">input_path</span><span class="p">))</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">data</span>
        <span class="c">## Done</span>
        
        <span class="c"># Determine the parameters that should be analyzed</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">operation_spec</span><span class="p">[</span><span class="s">&quot;parameters&quot;</span><span class="p">]</span>
        
        <span class="c"># Determine dependent parameters, which don&#39;t get extra resolution</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dep_par</span> <span class="o">=</span> <span class="n">operation_spec</span><span class="p">[</span><span class="s">&quot;dep_par&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">dep_par</span><span class="o">=</span><span class="p">[]</span>
        
        <span class="c"># Determine the metrics that should be plotted</span>
        <span class="n">spec_metrics</span> <span class="o">=</span> <span class="n">operation_spec</span><span class="p">[</span><span class="s">&quot;metrics&quot;</span><span class="p">]</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">spec_metrics</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">metric</span><span class="p">):</span>
                <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;The metric &quot;&#39;</span> <span class="o">+</span> <span class="n">metric</span> <span class="o">+</span> <span class="s">&#39;&quot; is not contained in the results csv file.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;No metric available from spec file, default to first dict entry.&#39;</span><span class="p">)</span>
            <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
            
        <span class="c"># Determine how many processes will be created</span>
        <span class="n">number_parameter_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]))</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">]</span>
        <span class="n">number_processes</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">_numberOfProcesses</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">number_parameter_values</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        
        <span class="n">logscale</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">operation_spec</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;logscale&#39;</span><span class="p">):</span>
            <span class="n">logscale</span> <span class="o">=</span> <span class="n">operation_spec</span><span class="p">[</span><span class="s">&#39;logscale&#39;</span><span class="p">]</span>
        
        <span class="n">markertype</span><span class="o">=</span><span class="s">&#39;x&#39;</span>
        <span class="k">if</span> <span class="n">operation_spec</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;markertype&#39;</span><span class="p">):</span>
            <span class="n">markertype</span> <span class="o">=</span> <span class="n">operation_spec</span><span class="p">[</span><span class="s">&#39;markertype&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># To better debug creation of processes we don&#39;t limit the queue </span>
            <span class="c"># and create all processes before executing them</span>
            <span class="n">processes</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
            <span class="n">cls</span><span class="o">.</span><span class="n">_createProcesses</span><span class="p">(</span><span class="n">processes</span><span class="p">,</span> <span class="n">result_directory</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> 
                                   <span class="n">dep_par</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">markertype</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span> <span class="n">processes</span><span class="p">,</span> <span class="n">operation_spec</span><span class="p">,</span> <span class="n">result_directory</span><span class="p">,</span> <span class="n">number_processes</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Create all plot processes by calling a recursive helper method in </span>
            <span class="c"># another thread so that already created processes can be executed</span>
            <span class="c"># although creation of processes is not finished yet. Therefore a queue </span>
            <span class="c"># is used which size is limited to guarantee that not to much objects </span>
            <span class="c"># are created (since this costs memory). However, the actual number </span>
            <span class="c"># of 100 is arbitrary and might be reviewed.</span>
            <span class="n">processes</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">create_process</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">cls</span><span class="o">.</span><span class="n">_createProcesses</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="p">(</span> <span class="n">processes</span><span class="p">,</span> <span class="n">result_directory</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> 
                                    <span class="n">parameters</span><span class="p">,</span> <span class="n">dep_par</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">markertype</span><span class="p">,</span> <span class="bp">True</span><span class="p">))</span>
            <span class="n">create_process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="c"># create and return the comp_analysis operation object</span>
            <span class="k">return</span> <span class="n">cls</span><span class="p">(</span> <span class="n">processes</span><span class="p">,</span> <span class="n">operation_spec</span><span class="p">,</span> <span class="n">result_directory</span><span class="p">,</span> 
                                   <span class="n">number_processes</span><span class="p">,</span> <span class="n">create_process</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="CompAnalysisOperation._numberOfProcesses"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisOperation._numberOfProcesses">[docs]</a>    <span class="k">def</span> <span class="nf">_numberOfProcesses</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">number_of_processes</span><span class="p">,</span> <span class="n">number_of_parameter_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Recursive function to determine the number of processes that </span>
<span class="sd">        will be created for the given *number_of_parameter_values*</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">number_of_parameter_values</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">number_of_processes</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">number_of_parameter_values</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">number_of_processes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">number_of_parameter_values</span><span class="p">)):</span>
                <span class="n">number_of_processes</span> <span class="o">+=</span> <span class="n">number_of_parameter_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> \
                  <span class="n">cls</span><span class="o">.</span><span class="n">_numberOfProcesses</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> 
                  <span class="p">[</span><span class="n">number_of_parameter_values</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> \
                  <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">number_of_parameter_values</span><span class="p">))</span> <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">])</span> <span class="o">+</span> \
                  <span class="n">number_of_parameter_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">number_of_processes</span>       
        </div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="CompAnalysisOperation._createProcesses"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisOperation._createProcesses">[docs]</a>    <span class="k">def</span> <span class="nf">_createProcesses</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">processes</span><span class="p">,</span> <span class="n">result_dir</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span><span class="n">dep_par</span><span class="p">,</span>
                         <span class="n">metrics</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">markertype</span><span class="p">,</span> <span class="n">top_level</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Recursive function that is used to create the analysis processes</span>
<span class="sd">        </span>
<span class="sd">        Each process creates one plot for each numeric parameter, each pair of</span>
<span class="sd">        numeric parameters, and each nominal parameter based on the data</span>
<span class="sd">        contained in the *data_dict*. The results are stored in *result_dir*.</span>
<span class="sd">        The method calls itself recursively for each value of each parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c"># Create the analysis process for the given parameters and the</span>
        <span class="c"># given data and put it in the executing-queue</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">CompAnalysisProcess</span><span class="p">(</span><span class="n">result_dir</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">markertype</span><span class="p">)</span>
        <span class="n">processes</span><span class="o">.</span><span class="n">put</span><span class="p">(</span> <span class="n">process</span> <span class="p">)</span>
        <span class="c"># If we have less than two parameters it does not make sense to</span>
        <span class="c"># split further</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">dep_par</span><span class="p">):</span>
            <span class="c"># If we have only one parameter to visualize,</span>
            <span class="c"># we don&#39;t need to create any further processes,</span>
            <span class="c"># and we have to finish the creating process.</span>
            <span class="k">return</span>
        
        <span class="c"># For each parameter</span>
        <span class="k">for</span> <span class="n">proj_parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proj_parameter</span> <span class="ow">in</span> <span class="n">dep_par</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c"># We split the data based on the values of this parameter</span>
            <span class="n">remaining_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameter</span> <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span>
                                        <span class="k">if</span> <span class="n">parameter</span> <span class="o">!=</span> <span class="n">proj_parameter</span><span class="p">]</span>
            <span class="c"># For each value the respective projection parameter can take on</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">proj_parameter</span><span class="p">]):</span>
                <span class="c"># Project the result dict onto the rows where the respective</span>
                <span class="c"># parameter takes on the given value</span>
                <span class="n">projected_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
                <span class="n">entries_added</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">parameter</span><span class="p">])):</span>
                    <span class="k">if</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">proj_parameter</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">entries_added</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="k">for</span> <span class="n">column_key</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">column_key</span> <span class="o">==</span> <span class="n">proj_parameter</span><span class="p">:</span> <span class="k">continue</span>
                            <span class="n">projected_dict</span><span class="p">[</span><span class="n">column_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">column_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="c"># If the projected_dict is empty we continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">entries_added</span><span class="p">:</span>
                    <span class="k">continue</span>
                
                <span class="c"># Create result_dir and do the recursive call for the</span>
                <span class="c"># projected data</span>
                <span class="n">proj_result_dir</span> <span class="o">=</span> <span class="n">result_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">#</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">proj_parameter</span><span class="p">,</span>
                                                                   <span class="n">value</span><span class="p">)</span>
                <span class="n">create_directory</span><span class="p">(</span><span class="n">proj_result_dir</span><span class="p">)</span>
                <span class="n">cls</span><span class="o">.</span><span class="n">_createProcesses</span><span class="p">(</span><span class="n">processes</span><span class="p">,</span> <span class="n">proj_result_dir</span><span class="p">,</span> <span class="n">projected_dict</span><span class="p">,</span>
                                     <span class="n">remaining_parameters</span><span class="p">,</span> <span class="n">dep_par</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">markertype</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">top_level</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># print &quot;last process created&quot;</span>
            <span class="c"># give executing process the sign that creation is now finished</span>
            <span class="n">processes</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="CompAnalysisOperation.consolidate"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisOperation.consolidate">[docs]</a>    <span class="k">def</span> <span class="nf">consolidate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

</div></div>
<div class="viewcode-block" id="CompAnalysisProcess"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess">[docs]</a><span class="k">class</span> <span class="nc">CompAnalysisProcess</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Process for analyzing and plotting data</span>
<span class="sd">    </span>
<span class="sd">    A *CompAnalysisProcess* is quite similar to a *AnalysisProcess*:</span>
<span class="sd">    </span>
<span class="sd">    An *CompAnalysisProcess* consists of evaluating the effect of several</span>
<span class="sd">    *parameters*  on a set of *metrics*. For each numeric parameter,</span>
<span class="sd">    each pair of numeric parameters and each nominal parameter,</span>
<span class="sd">    one plot is created for all metrics (instead of one plot for each metric as</span>
<span class="sd">    in *AnalysisProcess*).</span>
<span class="sd">    </span>
<span class="sd">    **Expected parameters**</span>
<span class="sd">      *result_dir* : The directory in which the actual results are stored</span>
<span class="sd">      *data_dict* : A dictionary containing all the data. The dictionary \</span>
<span class="sd">                    contains a mapping from an attribute  (e.g. accuracy) \</span>
<span class="sd">                    to a list of values taken by an attribute.  An entry is the\</span>
<span class="sd">                    entirety of all i-th values over all dict-values</span>
<span class="sd">      *parameters* : The parameters which have been varied during the \</span>
<span class="sd">                      experiment and whose effect on the *metrics* should be \</span>
<span class="sd">                      investigated. These must be keys of the *data_dict*.</span>
<span class="sd">      *metrics*: The metrics the should be evaluated. Must be keys of the \</span>
<span class="sd">                 *data_dict*.</span>
<span class="sd">      *logscale*: Boolean, numeric x-axis will be scaled log&#39;ly if true.</span>
<span class="sd">      *markertype*: A string like &#39;.&#39; defining the marker type for certain \</span>
<span class="sd">                    plots. Default is &#39;x&#39;.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="CompAnalysisProcess.__init__"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result_dir</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">markertype</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CompAnalysisProcess</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">result_dir</span> <span class="o">=</span> <span class="n">result_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="o">=</span> <span class="n">data_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logscale</span> <span class="o">=</span> <span class="n">logscale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markertype</span> <span class="o">=</span> <span class="n">markertype</span>
        <span class="c"># Usually the value of a metric for a certain situation is just a scalar</span>
        <span class="c"># value. However, for certain metrics the value can be a sequence</span>
        <span class="c"># (typically the change of some measure over time). These cases must be</span>
        <span class="c"># indicated externally by the the usage of (&quot;metric_name&quot;, &quot;sequence&quot;)</span>
        <span class="c"># instead of just &quot;mteric_name&quot;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">[(</span><span class="n">metric</span><span class="p">,</span> <span class="s">&quot;scalar&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span>
                            <span class="k">else</span> <span class="n">metric</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">]</span>
    </div>
<div class="viewcode-block" id="CompAnalysisProcess.__call__"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess.__call__">[docs]</a>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes this process on the respective modality</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c"># Restore configuration</span>
        <span class="n">pySPACE</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span>
        
        <span class="c">############## Prepare benchmarking ##############</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CompAnalysisProcess</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">pre_benchmarking</span><span class="p">()</span>
        
        <span class="c"># Split parameters into nominal and numeric parameters</span>
        <span class="n">nominal_parameters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">numeric_parameters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c"># Try to create a float of the first value of the parameter</span>
                <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="c"># No exception thus a numeric attribute</span>
                <span class="n">numeric_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c"># This is not a numeric parameter, treat it as nominal</span>
                <span class="n">nominal_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="c">#&quot;This exception should inform the user about wrong parameters in his YAML file.&quot;, said Jan-Hendrik-Metzen.</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;The parameter &quot;&#39;</span> <span class="o">+</span> <span class="n">parameter</span> <span class="o">+</span> <span class="s">&#39;&quot; is not contained in the performance results.&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="c">#This exception informs the user about wrong parameters in his YAML file.</span>
                <span class="kn">import</span> <span class="nn">warnings</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;The parameter &quot;&#39;</span> <span class="o">+</span> <span class="n">parameter</span> <span class="o">+</span> <span class="s">&#39;&quot; could not be found.&#39;</span><span class="p">)</span>
            <span class="c">#TODO: Better exception treatment! The Program should ignore unknown</span>
            <span class="c"># parameters and go on after giving information on the wrong parameter.</span>
        
        <span class="c">#Create the figure and initialize ...</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="p">[]</span> <span class="c">#... a list of matplotlib axes objects</span>
        <span class="n">im</span> <span class="o">=</span> <span class="p">[]</span> <span class="c">#... and images. This is needed for the color bars of</span>
                <span class="c"># contour plots</span>
        
        <span class="c"># For all performance measures</span>
        <span class="c"># Pass figure and axes to functions, let them add their plot,</span>
        <span class="c"># then return fig and axes.</span>
        <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">metric</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;scalar&#39;</span><span class="p">:</span>
                <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scalar_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numeric_parameters</span><span class="p">,</span>
                                    <span class="n">nominal_parameters</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="n">im</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span> <span class="c"># Don&#39;t need the image in this case</span>
                <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numeric_parameters</span><span class="p">,</span>
                                      <span class="n">nominal_parameters</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">metric</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        
        <span class="n">nmetrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span> <span class="c"># Check Nr of metrices</span>
        <span class="n">naxes</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span>              <span class="c"># and axes</span>
        <span class="c"># And compute how many subplot columns are needed</span>
        <span class="n">plot_cols</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">naxes</span><span class="p">)</span>
                                         <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">nmetrics</span><span class="p">)))</span>
        
        <span class="c"># Now loop the axes</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">naxes</span><span class="p">):</span>
            <span class="c"># And move every single one to it&#39;s desired location</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">change_geometry</span><span class="p">(</span><span class="n">nmetrics</span><span class="p">,</span> <span class="n">plot_cols</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c"># in case of a contour plot also add a corresponding colorbar...</span>
            <span class="k">if</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_label</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;C&#39;</span><span class="p">:</span>
                <span class="n">fig1</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">pylab</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c">#... by using the correct image</span>
        
        <span class="c"># enlarge canvas so that nothing overlaps</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span> <span class="o">*</span> <span class="n">plot_cols</span><span class="p">,</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">nmetrics</span><span class="p">))</span>
        <span class="c"># save...</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s%s</span><span class="s">plot.pdf&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s">&quot;tight&quot;</span><span class="p">)</span>
        <span class="c"># and clean up.</span>
        <span class="k">del</span> <span class="n">fig1</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
        <span class="c">############## Clean up after benchmarking ##############</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CompAnalysisProcess</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">post_benchmarking</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="CompAnalysisProcess._scalar_metric"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess._scalar_metric">[docs]</a>    <span class="k">def</span> <span class="nf">_scalar_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">numeric_parameters</span><span class="p">,</span> <span class="n">nominal_parameters</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates the plots for a scalar metric &quot;&quot;&quot;</span>
        <span class="c"># For all numeric parameters</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">parameter1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numeric_parameters</span><span class="p">):</span>
            <span class="c"># need not to save image in these cases, as no colorbar is needed</span>
            <span class="n">im</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_dir</span><span class="p">,</span>
                               <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
                               <span class="n">x_key</span><span class="o">=</span><span class="n">parameter1</span><span class="p">,</span>
                               <span class="n">y_key</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
                               <span class="n">one_figure</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                               <span class="n">show_errors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            
            <span class="c"># For all combinations of two numeric parameters</span>
            <span class="k">for</span> <span class="n">parameter2</span> <span class="ow">in</span> <span class="n">numeric_parameters</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
                <span class="n">axis_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameter1</span><span class="p">,</span> <span class="n">parameter2</span><span class="p">]</span>
                <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_numeric_vs_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="p">,</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">result_dir</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span>
                                              <span class="n">axis_keys</span><span class="o">=</span><span class="n">axis_keys</span><span class="p">,</span>
                                              <span class="n">value_key</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
            
            <span class="c"># For all combinations of a numeric and a nominal parameter</span>
            <span class="k">for</span> <span class="n">parameter2</span> <span class="ow">in</span> <span class="n">nominal_parameters</span><span class="p">:</span>
                <span class="n">im</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">axis_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameter1</span><span class="p">,</span> <span class="n">parameter2</span><span class="p">]</span>
                <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_numeric_vs_nominal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="p">,</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">result_dir</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span>
                                              <span class="n">numeric_key</span><span class="o">=</span><span class="n">parameter1</span><span class="p">,</span>
                                              <span class="n">nominal_key</span><span class="o">=</span><span class="n">parameter2</span><span class="p">,</span>
                                              <span class="n">value_key</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
                <span class="c"># fig1.gca().set_xlim(0.0, 0.01)</span>
                <span class="c"># fig1.gca().set_xscale(&#39;log&#39;)</span>
        
        <span class="c"># For all nominal parameters:</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">parameter1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nominal_parameters</span><span class="p">):</span>
            <span class="n">im</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_nominal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_dir</span><span class="p">,</span>
                               <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">x_key</span><span class="o">=</span><span class="n">parameter1</span><span class="p">,</span>
                               <span class="n">y_key</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span>
    </div>
<div class="viewcode-block" id="CompAnalysisProcess._sequence_metric"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess._sequence_metric">[docs]</a>    <span class="k">def</span> <span class="nf">_sequence_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">numeric_parameters</span><span class="p">,</span> <span class="n">nominal_parameters</span><span class="p">,</span>
                         <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">mwa_window_length</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates the plots for a sequence metric</span>
<span class="sd">        </span>
<span class="sd">        .. todo:: Do not distinguish nominal and numeric parameters for the moment</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">numeric_parameters</span><span class="p">)</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nominal_parameters</span><span class="p">)</span>
        
        <span class="n">metric_values</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">eval</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="p">[</span><span class="n">metric</span><span class="p">])</span>
        <span class="c"># Sometimes, the number of values are not identical, so we cut all to</span>
        <span class="c"># the same minimal length</span>
        <span class="n">num_values</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">metric_values</span><span class="p">))</span>
        <span class="n">metric_values</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_values</span><span class="p">],</span> <span class="n">metric_values</span><span class="p">)</span>
        
        <span class="c"># Moving window average of the metric values</span>
        <span class="n">mwa_metric_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">metric_values</span><span class="p">:</span>
            <span class="n">mwa_metric_values</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)):</span>
                <span class="c"># Chop window such that does not go beyond the range of</span>
                <span class="c"># available values</span>
                <span class="n">window_width</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">-</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                   <span class="n">mwa_window_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">subrange</span> <span class="o">=</span> <span class="p">(</span><span class="n">index</span> <span class="o">-</span> <span class="n">window_width</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="n">window_width</span><span class="p">)</span>
                <span class="n">mwa_metric_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="n">subrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">subrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>
        
        <span class="c"># For each parameter</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="c"># Split the data according to the values the parameter takes on</span>
            <span class="n">curves</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="p">[</span><span class="n">parameter</span><span class="p">])):</span>
                <span class="n">curves</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span><span class="p">[</span><span class="n">parameter</span><span class="p">][</span><span class="n">row</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mwa_metric_values</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
            
            <span class="c"># Plot the mean curve over all runs for this parameter setting</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">parameter_value</span><span class="p">,</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">curves</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="c"># Create a simple plot</span>
                <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">metric_values</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                           <span class="n">label</span><span class="o">=</span><span class="n">parameter_value</span><span class="p">)</span>
<span class="c">#                # Create an errorbar plot</span>
<span class="c">#                pylab.errorbar(x = range(len(metric_values[0])),</span>
<span class="c">#                               y = numpy.mean(curve, 0),</span>
<span class="c">#                               yerr = numpy.std(curve, 0),</span>
<span class="c">#                               elinewidth = 1, capsize = 5,</span>
<span class="c">#                               label = parameter_value)</span>
            
            <span class="n">lg</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fancybox</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">lg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">&#39;0.90&#39;</span><span class="p">)</span>
            <span class="n">lg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
            
            <span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Step&quot;</span><span class="p">)</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span>
    </div>
<div class="viewcode-block" id="CompAnalysisProcess._plot_numeric"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess._plot_numeric">[docs]</a>    <span class="k">def</span> <span class="nf">_plot_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">result_dir</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">x_key</span><span class="p">,</span> <span class="n">y_key</span><span class="p">,</span> <span class="n">conditions</span><span class="o">=</span><span class="p">[],</span>
                          <span class="n">one_figure</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">show_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a plot of the y_keys for the given numeric parameter x_key.</span>
<span class="sd">        </span>
<span class="sd">        A method that  allows to create a plot that visualizes the effect</span>
<span class="sd">        of differing one variable onto a second one (e.g. the effect of</span>
<span class="sd">        differing the number of features onto the accuracy).</span>
<span class="sd">        </span>
<span class="sd">        **Expected parameters**</span>
<span class="sd">          *data* : A dictionary, that contains a mapping from an attribute \</span>
<span class="sd">                  (e.g. accuracy) to a list of values taken by an attribute. \</span>
<span class="sd">                  An entry is the entirety of all i-th values over all dict-values</span>
<span class="sd">                  </span>
<span class="sd">          *result_dir* : The directory in which the plots will be saved.</span>
<span class="sd">          </span>
<span class="sd">          *x_key* : The key of the dictionary whose values should be used as \</span>
<span class="sd">                    values for the x-axis (the independent variables)</span>
<span class="sd">                    </span>
<span class="sd">          *y_key* : The key of the dictionary whose values should be used as\</span>
<span class="sd">                    values for the y-axis, i.e. the dependent variables\</span>
<span class="sd">                    </span>
<span class="sd">          *conditions* : A list of functions that need to be fulfilled in order to \</span>
<span class="sd">                         use one entry in the plot. Each function has to take two \</span>
<span class="sd">                         arguments: The data dictionary containing all entries and \</span>
<span class="sd">                         the index of the entry that should be checked. Each condition \</span>
<span class="sd">                         must return a boolean value.</span>
<span class="sd">                         </span>
<span class="sd">          *one_figure* : If true, all curves are plotted in the same figure.</span>
<span class="sd">                         Otherwise, for each value of curve_key, a new figure\</span>
<span class="sd">                         is generated (currently ignored)</span>
<span class="sd">                         </span>
<span class="sd">          *show_errors* : If true, error bars are plotted</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_key</span><span class="p">)</span>
        
        <span class="n">curves</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x_key</span><span class="p">])):</span>
            <span class="c"># Check is this particular entry should be used</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">condition</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">conditions</span><span class="p">):</span>
                <span class="k">continue</span>
            
            <span class="c"># Get the value of the independent variable for this entry</span>
            <span class="n">x_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="c"># Attach the corresponding value to the respective partition</span>
            <span class="n">y_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">y_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">curves</span><span class="p">[</span><span class="n">y_key</span><span class="p">][</span><span class="n">x_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_value</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">y_key</span><span class="p">,</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">curves</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">curve_x</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">curve_y</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_values</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()):</span>
                <span class="n">curve_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_value</span><span class="p">)</span>
                <span class="n">curve_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
            
            <span class="c"># create the actual plot</span>
            <span class="k">if</span> <span class="n">show_errors</span><span class="p">:</span>
                <span class="c"># Create an error bar plot</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">markertype</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">linestyle</span> <span class="o">=</span> <span class="s">&#39;-&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">linestyle</span> <span class="o">=</span> <span class="s">&#39;--&#39;</span>
                <span class="n">pylab</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">curve_x</span><span class="p">,</span>
                               <span class="n">y</span><span class="o">=</span><span class="nb">map</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">curve_y</span><span class="p">),</span>
                               <span class="n">yerr</span><span class="o">=</span><span class="nb">map</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">curve_y</span><span class="p">),</span>
                               <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="n">y_key</span><span class="p">,</span>
                               <span class="n">fmt</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                               <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">markertype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># Create a simple plot</span>
                <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve_x</span><span class="p">,</span>
                           <span class="nb">map</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">curve_y</span><span class="p">),</span>
                           <span class="n">label</span><span class="o">=</span><span class="n">y_key</span><span class="p">)</span>
        
        <span class="n">lg</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">lg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">&#39;0.90&#39;</span><span class="p">)</span>
        <span class="n">lg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
        
        <span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_key</span><span class="p">)</span>
        <span class="c"># pylab.title(&#39;_plot_numeric&#39;)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logscale</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">left_lim</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">curve_x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">21.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">curve_x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span>
            <span class="n">right_lim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">curve_x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">21.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">curve_x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left_lim</span><span class="p">,</span> <span class="n">right_lim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">border</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">curve_x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">curve_x</span><span class="p">))</span><span class="o">/</span><span class="mi">20</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">curve_x</span><span class="p">)</span><span class="o">-</span><span class="n">border</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">curve_x</span><span class="p">)</span><span class="o">+</span><span class="n">border</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span>

    </div>
<div class="viewcode-block" id="CompAnalysisProcess._plot_numeric_vs_numeric"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess._plot_numeric_vs_numeric">[docs]</a>    <span class="k">def</span> <span class="nf">_plot_numeric_vs_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">result_dir</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">axis_keys</span><span class="p">,</span> <span class="n">value_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Contour plot of the value_keys for the two numeric parameters axis_keys.</span>
<span class="sd">        </span>
<span class="sd">        A method that  allows to create a contour plot that visualizes the effect</span>
<span class="sd">        of differing two variables on a third one (e.g. the effect of differing</span>
<span class="sd">        the lower and upper cutoff frequency of a bandpass filter onto</span>
<span class="sd">        the accuracy).</span>
<span class="sd">        </span>
<span class="sd">        **Expected parameters**</span>
<span class="sd">          *data* : A dictionary that contains a mapping from an attribute \</span>
<span class="sd">                   (e.g. accuracy) to a list of values taken by an attribute. \</span>
<span class="sd">                   An entry is the entirety of all i-th values over all dict-values.</span>

<span class="sd">          *result_dir*: The directory in which the plots will be saved.</span>

<span class="sd">          *axis_keys*: The two keys of the dictionary that are assumed to have \</span>
<span class="sd">                       an effect on a third variable (the dependent variable)</span>

<span class="sd">          *value_key*: The dependent variables whose values determine the \</span>
<span class="sd">                       color of the contour plot</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">axis_keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="c"># Determine a sorted list of the values taken on by the axis keys:</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])</span>
        <span class="n">x_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>
        
        <span class="n">y_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
        <span class="n">y_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_values</span><span class="p">))</span>

        <span class="c"># We cannot create a contour plot if one dimension is only 1d so we</span>
        <span class="c"># return the unchanged figure</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">C&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c"># Create a meshgrid of them</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">)</span>
        <span class="c"># Determine the average value taken on by the dependent variable</span>
        <span class="c"># for each combination of the the two source variables</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">)))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]])):</span>
            <span class="n">x_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">y_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">value_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">Z</span><span class="p">[</span><span class="n">x_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x_value</span><span class="p">),</span> <span class="n">y_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">y_value</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">value</span>
            <span class="n">counter</span><span class="p">[</span><span class="n">x_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x_value</span><span class="p">),</span> <span class="n">y_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">y_value</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">/</span> <span class="n">counter</span>
        
        <span class="c"># Create the plot for this specific dependent variable</span>
        <span class="c">#pylab.figure()</span>
        <span class="c">#cf = pylab.contourf(X, Y, Z.T, N=20)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pylab</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
        
        <span class="c">#pylab.colorbar(cf)</span>
        <span class="c">#pylab.colorbar(cf)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logscale</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        
        <span class="n">pylab</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y_values</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_values</span><span class="p">))</span>
        
        <span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">axis_keys</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span> <span class="n">value_key</span> <span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logscale</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span>
        
    </div>
<div class="viewcode-block" id="CompAnalysisProcess._plot_numeric_vs_nominal"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess._plot_numeric_vs_nominal">[docs]</a>    <span class="k">def</span> <span class="nf">_plot_numeric_vs_nominal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">result_dir</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">numeric_key</span><span class="p">,</span>
                                 <span class="n">nominal_key</span><span class="p">,</span> <span class="n">value_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot for comparison of several different values of a nominal parameter</span>
<span class="sd">        </span>
<span class="sd">        A method that  allows to create a plot that visualizes the effect of</span>
<span class="sd">        varying one numeric parameter onto the performance for several</span>
<span class="sd">        different values of a nominal parameter.</span>
<span class="sd">        </span>
<span class="sd">        **Expected parameters**</span>
<span class="sd">          * data* : A dictionary that contains a mapping from an attribute \</span>
<span class="sd">                    (e.g. accuracy) to a list of values taken by an attribute. \</span>
<span class="sd">                    An entry is the entirety of all i-th values over all dict-values.</span>
<span class="sd">                    </span>
<span class="sd">          *result_dir*: The directory in which the plots will be saved.</span>
<span class="sd">          </span>
<span class="sd">          *numeric_key*: The numeric parameter whose effect (together with the \</span>
<span class="sd">                         nominal parameter) onto the dependent variable should \</span>
<span class="sd">                         be investigated.</span>
<span class="sd">        </span>
<span class="sd">         *nominal_key*: The nominal parameter whose effect (together with the \</span>
<span class="sd">                        numeric parameter) onto the dependent variable should</span>
<span class="sd">                        be investigated.</span>
<span class="sd">        </span>
<span class="sd">          *value_key* : The dependent variables whose values determine the \</span>
<span class="sd">                        color of the contour plot</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c"># Determine a mapping from the value of the nominal value to a mapping</span>
        <span class="c"># from the value of the numeric value to the achieved performance:</span>
        <span class="c"># nominal -&gt; (numeric -&gt; performance)</span>
        <span class="n">curves</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">nominal_key</span><span class="p">])):</span>
            <span class="n">curve_key</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">nominal_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">parameter_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">numeric_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">value_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">&quot;#&quot;</span><span class="p">:</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">value_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># A weighted cost function</span>
                <span class="n">weight1</span><span class="p">,</span> <span class="n">value_key1</span><span class="p">,</span> <span class="n">weight2</span><span class="p">,</span> <span class="n">value_key2</span> <span class="o">=</span> <span class="n">value_key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">value_key1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> \
                                        <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">value_key2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            
            <span class="n">curves</span><span class="p">[</span><span class="n">curve_key</span><span class="p">][</span><span class="n">parameter_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">performance_value</span><span class="p">)</span>
        
        <span class="n">linecycler</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">([</span><span class="s">&#39;-&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;-.&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span> <span class="o">+</span>
                                      <span class="p">[</span><span class="s">&#39;:&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;--&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">next</span>
        
        <span class="c"># Iterate over all values of the nominal parameter and create one curve</span>
        <span class="c"># in the plot showing the mapping from numeric parameter to performance</span>
        <span class="c"># for this particular value of the nominal parameter</span>
        <span class="n">minmax_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">pylab</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="o">-</span><span class="n">pylab</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">curve_key</span><span class="p">,</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">curves</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">x_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">y_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x_value</span><span class="p">,</span> <span class="n">y_value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()):</span>
                <span class="n">x_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_value</span><span class="p">)</span>
                <span class="c"># Plot the mean of all values of the performance for this</span>
                <span class="c"># particular combination of nominal and numeric parameter</span>
                <span class="n">y_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pylab</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_value</span><span class="p">))</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">markertype</span><span class="p">,</span>
                       <span class="n">label</span><span class="o">=</span><span class="n">curve_key</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linecycler</span><span class="p">())</span>
            <span class="n">minmax_x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">minmax_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">x_values</span><span class="p">)),</span>
                        <span class="nb">max</span><span class="p">(</span><span class="n">minmax_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_values</span><span class="p">))]</span>
        
        <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">numeric_key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">value_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">&quot;#&quot;</span><span class="p">:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">value_key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">+</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value_key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)))</span>
        
        <span class="c"># Shrink legend if too many curves</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s">&#39;small&#39;</span><span class="p">)</span>
            <span class="n">lg</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="n">prop</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fancybox</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lg</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">fancybox</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">lg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">&#39;0.90&#39;</span><span class="p">)</span>
        <span class="n">lg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logscale</span><span class="p">:</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">left_lim</span> <span class="o">=</span> <span class="n">minmax_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">21.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">minmax_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span>
                <span class="n">right_lim</span> <span class="o">=</span> <span class="n">minmax_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">21.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">minmax_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">20.0</span><span class="p">)</span>
                <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left_lim</span><span class="p">,</span> <span class="n">right_lim</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">border</span> <span class="o">=</span> <span class="p">(</span><span class="n">minmax_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">minmax_x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">20</span>
            <span class="n">fig1</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">minmax_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">border</span><span class="p">,</span><span class="n">minmax_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">border</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span>

    </div>
<div class="viewcode-block" id="CompAnalysisProcess._plot_nominal"><a class="viewcode-back" href="../../../../api/generated/pySPACE.missions.operations.comp_analysis.html#pySPACE.missions.operations.comp_analysis.CompAnalysisProcess._plot_nominal">[docs]</a>    <span class="k">def</span> <span class="nf">_plot_nominal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">result_dir</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">x_key</span><span class="p">,</span> <span class="n">y_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a boxplot of the y_keys for the given nominal parameter x_key.</span>
<span class="sd">        </span>
<span class="sd">        A method that  allows to create a plot that visualizes the effect</span>
<span class="sd">        of differing one nominal  variable onto a second one (e.g. the effect of</span>
<span class="sd">        differing the classifier onto the accuracy).</span>
<span class="sd">        </span>
<span class="sd">        **Expected parameters**</span>
<span class="sd">          *data*:  A dictionary, that contains a mapping from an attribute \</span>
<span class="sd">                   (e.g. accuracy) to a list of values taken by an attribute. \</span>
<span class="sd">                   An entry is the entirety of all i-th values over all dict-values</span>
<span class="sd">                   </span>
<span class="sd">          *result_dir*: The director in which the plots will be saved.</span>
<span class="sd">          </span>
<span class="sd">          *x_key*: The key of the dictionary whose values should be used as \</span>
<span class="sd">                    values for the x-axis (the independent variables)</span>
<span class="sd">                    </span>
<span class="sd">          *y_key*: The key of the dictionary whose values should be used as\</span>
<span class="sd">                    values for the y-axis, i.e. the dependent variable</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c"># Create the plot for this specific dependent variable</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x_key</span><span class="p">])):</span>
            <span class="n">parameter_value</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">y_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">&quot;#&quot;</span><span class="p">:</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">y_key</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c"># A weighted cost function</span>
                <span class="n">weight1</span><span class="p">,</span> <span class="n">y_key1</span><span class="p">,</span> <span class="n">weight2</span><span class="p">,</span> <span class="n">y_key2</span> <span class="o">=</span> <span class="n">y_key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)</span>
                <span class="n">performance_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">y_key1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> \
                                        <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">weight2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">y_key2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            
            <span class="n">values</span><span class="p">[</span><span class="n">parameter_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">performance_value</span><span class="p">)</span>
        
        <span class="n">values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="c">#        values = [(&quot;Standard_vs_Target&quot;, values[&quot;Standard_vs_Target&quot;]),</span>
<span class="c">#                  (&quot;MissedTarget_vs_Target&quot;, values[&quot;MissedTarget_vs_Target&quot;])]</span>
        
        <span class="n">pylab</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,)</span> <span class="c"># the bottom of the subplots of the figure</span>
                             
        <span class="c"># pylab.boxplot(map(lambda x: x[1], values))</span>
        
        <span class="n">b</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">values</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">medlines</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="s">&#39;medians&#39;</span><span class="p">]</span>
        <span class="n">medians</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medlines</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medians</span><span class="p">)):</span>
            <span class="n">medians</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">medlines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># create array with median labels with 2 decimal places of precision</span>
        <span class="n">upperLabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">medians</span><span class="p">]</span>
        
        <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">))</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span> <span class="o">-</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="s">&#39;x-small&#39;</span><span class="p">)</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        
        <span class="c"># top = pylab.gca().get_ylim()[1]</span>
        <span class="c">#         for i in range(len(medians)):</span>
        <span class="c">#             pylab.gca().text(i+1,top-(top*0.05),upperLabels[i],</span>
        <span class="c">#                 horizontalalignment=&#39;center&#39;, size=&#39;x-small&#39;)</span>
        
        <span class="n">bottom</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">medians</span><span class="p">)):</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">bottom</span><span class="o">+</span><span class="p">(</span><span class="n">bottom</span><span class="o">*</span><span class="mf">0.05</span><span class="p">),</span><span class="n">upperLabels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                  <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&#39;x-small&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">y_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">&quot;#&quot;</span><span class="p">:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">+</span><span class="si">%s</span><span class="s">*</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">y_key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">ax</span>
</pre></div></div></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">pySPACE 0.5 alpha documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, pySPACE Developer Team.
      Last updated on Aug 07, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>